<!DOCTYPE html><html><head>
      <title>please-stop-calling-databases-cp-or-ap</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css">
      
      

      
      
      
      
      
      
      

      <style>
      /**
 * VS theme by Andrew Lock (https://andrewlock.net)
 * Inspired by Visual Studio syntax coloring
 */

code[class*="language-"],
pre[class*="language-"] {
    color: #000000;
    font-family: "Consolas", monospace;
    direction: ltr;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    font-size: 12px;
    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;
    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
}

pre[class*="language-"]::-moz-selection,
pre[class*="language-"] ::-moz-selection,
code[class*="language-"]::-moz-selection,
code[class*="language-"] ::-moz-selection {
    background: #C1DEF1;
}

pre[class*="language-"]::selection,
pre[class*="language-"] ::selection,
code[class*="language-"]::selection,
code[class*="language-"] ::selection {
    background: #C1DEF1;
}


/* Code blocks */

pre[class*="language-"] {
    padding: 1em;
    margin: .5em 0;
    overflow: auto;
    background-color: #f9f9f9;
}


/* Inline code */

:not(pre)>code[class*="language-"] {
    padding: .2em;
    padding-top: 1px;
    padding-bottom: 1px;
    background: #EEE;
}

.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
    color: #0066FF;
    font-style: italic;
}

.token.namespace {
    opacity: .7;
}

.token.string {
    color: #036A07;
}

.token.punctuation {
    color: #000000;
}

.token.operator {
    color: #0066FF;
    font-weight: 900;
    /* no highlight */
}

.token.url,
.token.symbol,
.token.number,
.token.boolean,
.token.variable,
.token.constant,
.token.inserted {
    color: #0000CD;
}

.token.atrule,
.token.keyword,
.token.attr-value,
.language-autohotkey .token.selector,
.language-json .token.boolean,
.language-json .token.number,
code[class*="language-css"] {
    color: #0000ff;
    font-weight: 900;
}

.token.function {
    color: #000000;
}

.token.deleted,
.language-autohotkey .token.tag {
    color: #9a050f;
}

.token.selector,
.language-autohotkey .token.keyword {
    color: #00009f;
}

.token.important,
.token.bold {
    font-weight: bold;
}

.token.italic {
    font-style: italic;
}

.token.class-name,
.language-json .token.property {
    color: #2B91AF;
}

.token.tag,
.token.selector {
    color: #800000;
}

.token.attr-name,
.token.property,
.token.regex,
.token.entity {
    color: #19921c;
}

.token.directive.tag .tag {
    background: #ffff00;
    color: #000000;
}


/* overrides color-values for the Line Numbers plugin
 * http://prismjs.com/plugins/line-numbers/
 */

.line-numbers .line-numbers-rows {
    border-right-color: #a5a5a5;
}

.line-numbers-rows>span:before {
    color: #2B91AF;
}


/* overrides color-values for the Line Highlight plugin
* http://prismjs.com/plugins/line-highlight/
*/

.line-highlight {
    background: rgba(193, 222, 241, 0.2);
    background: -webkit-linear-gradient(left, rgba(193, 222, 241, 0.2) 70%, rgba(221, 222, 241, 0));
    background: linear-gradient(to right, rgba(193, 222, 241, 0.2) 70%, rgba(221, 222, 241, 0));
}


/* highlight */

pre[data-line] {
    position: relative;
    padding: 1em 0 1em 3em;
}

pre[data-line] .line-highlight-wrapper {
    position: absolute;
    top: 0;
    left: 0;
    background-color: transparent;
    display: block;
    width: 100%;
}

pre[data-line] .line-highlight {
    position: absolute;
    left: 0;
    right: 0;
    padding: inherit 0;
    margin-top: 1em;
    background: hsla(24, 20%, 50%, .08);
    background: linear-gradient(to right, hsla(24, 20%, 50%, .1) 70%, hsla(24, 20%, 50%, 0));
    pointer-events: none;
    line-height: inherit;
    white-space: pre;
}

pre[data-line] .line-highlight:before,
pre[data-line] .line-highlight[data-end]:after {
    content: attr(data-start);
    position: absolute;
    top: .4em;
    left: .6em;
    min-width: 1em;
    padding: 0 .5em;
    background-color: hsla(24, 20%, 50%, .4);
    color: hsl(24, 20%, 95%);
    font: bold 65%/1.5 sans-serif;
    text-align: center;
    vertical-align: .3em;
    text-shadow: none;
    box-shadow: 0 1px white;
}

pre[data-line] .line-highlight[data-end]:after {
    content: attr(data-end);
    top: auto;
    bottom: .4em;
}html body {
    font-family: "Consolas", Arial, freesans, sans-serif;
    font-size: 12px;
    height: 100%;
    color: #2F2F2F;
    background-color: #fff;
    overflow: initial;
    box-sizing: border-box;
    word-wrap: break-word;
}

html body h1 {
    color: #4169E1;
    font-weight: bold;
    font-size: 12px;
    font-weight: 600;
    margin-top: 3em;
}

html body h2,
html body h3,
html body h4,
html body h5,
html body h6 {
    color: #2b2b2b;
    font-weight: bold;
    font-size: 12px;
    font-weight: 600;
}

html body strong {
    color: #000
}

html body del {
    color: #5c5c5c
}

html body a:not([href]) {
    color: inherit;
    text-decoration: none
}

html body a {
    color: #4169E1;
    text-decoration: none
}

html body a:hover {
    color: #4169E1;
    text-decoration: none
}

html body img {
    max-width: 100%
}

html body>p {
    display: block;
    margin-block-start: 0em;
    margin-block-end: 0em;
    margin-inline-start: 0px;
    margin-inline-end: 0px;
    word-wrap: break-word;
}

html body>ul,
html body>ol {
    margin-bottom: 0px
}

html body ul,
html body ol {
    padding-left: 2em
}

html body ul.no-list,
html body ol.no-list {
    padding: 0;
    list-style-type: none
}

html body ul ul,
html body ul ol,
html body ol ol,
html body ol ul {
    margin-top: 0;
    margin-bottom: 0
}

html body li {
    margin-bottom: 0
}

html body li.task-list-item {
    list-style: none
}

html body li>p {
    margin-top: 0;
    margin-bottom: 0
}

html body .task-list-item-checkbox {
    margin: 0 .2em .25em -1.8em;
    vertical-align: middle
}

html body .task-list-item-checkbox:hover {
    cursor: pointer
}

html body blockquote {
    margin: 16px 0;
    font-size: inherit;
    padding: 0 15px;
    color: #5c5c5c;
    border-left: 4px solid #d6d6d6
}

html body blockquote>:first-child {
    margin-top: 0
}

html body blockquote>:last-child {
    margin-bottom: 0
}

html body hr {
    height: 4px;
    margin: 32px 0;
    background-color: #d6d6d6;
    border: 0 none
}

html body table {
    margin: 10px 0 15px 0;
    border-collapse: collapse;
    border-spacing: 0;
    display: block;
    width: 100%;
    overflow: auto;
    word-break: normal;
    word-break: keep-all
}

html body table th {
    font-weight: bold;
    color: #000
}

html body table td,
html body table th {
    border: 1px solid #d6d6d6;
    padding: 6px 13px
}

html body dl {
    padding: 0
}

html body dl dt {
    padding: 0;
    margin-top: 16px;
    font-size: 1em;
    font-style: italic;
    font-weight: bold
}

html body dl dd {
    padding: 0 16px;
    margin-bottom: 0px
}

html body code {
    font-family: Consolas, monospace;
    font-size: 12px !important;
    color: #000;
    background-color: #f0f0f0;
}

html body code::before,
html body code::after {
    letter-spacing: -0.2em;
    content: "\00a0"
}

html body pre>code {
    padding: 0;
    margin: 0;
    font-size: .85em !important;
    word-break: normal;
    white-space: pre;
    background: transparent;
    border: 0
}

html body .highlight {
    margin-bottom: 0px
}

html body .highlight pre,
html body pre {
    padding: 1em;
    overflow: auto;
    font-size: .85em !important;
    line-height: 1.45;
    border: #d6d6d6;
    border-radius: 3px
}

html body .highlight pre {
    margin-bottom: 0;
    word-break: normal
}

html body pre code,
html body pre tt {
    display: inline;
    max-width: initial;
    padding: 0;
    margin: 0;
    overflow: initial;
    line-height: inherit;
    word-wrap: normal;
    background-color: transparent;
    border: 0
}

html body pre code:before,
html body pre tt:before,
html body pre code:after,
html body pre tt:after {
    content: normal
}

html body p,
html body blockquote,
html body ul,
html body ol,
html body dl,
html body pre {
    /* nothing */
}

html body kbd {
    color: #000;
    border: 1px solid #d6d6d6;
    border-bottom: 2px solid #c7c7c7;
    padding: 2px 4px;
    background-color: #f0f0f0;
    border-radius: 3px
}

@media print {
    html body {
        background-color: #fff
    }
    html body h1,
    html body h2,
    html body h3,
    html body h4,
    html body h5,
    html body h6 {
        color: #000;
        page-break-after: avoid
    }
    html body blockquote {
        color: #5c5c5c
    }
    html body pre {
        page-break-inside: avoid
    }
    html body table {
        display: table
    }
    html body img {
        display: block;
        max-width: 100%;
        max-height: 100%
    }
    html body pre,
    html body code {
        word-wrap: break-word;
        white-space: pre
    }
}

.markdown-preview {
    float: left;
    margin: 10px auto 10px 10px;
    color: #2F2F2F;
    border: 1px dashed #DDDDDD;
    padding: 10px;
    width: 80em;
}

p {
    margin: 1em 0 1em 0;
}


/* code block theme */.markdown-preview {
    height: 100%;
    box-sizing: border-box
}

.markdown-preview .pagebreak,
.markdown-preview .newpage {
    page-break-before: always
}

.markdown-preview pre.line-numbers {
    position: relative;
    padding-left: 3.8em;
    counter-reset: linenumber
}

.markdown-preview pre.line-numbers>code {
    position: relative
}

.markdown-preview pre.line-numbers .line-numbers-rows {
    position: absolute;
    pointer-events: none;
    top: 1em;
    font-size: 100%;
    left: 0;
    width: 3em;
    letter-spacing: -1px;
    border-right: 1px solid #999;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none
}

.markdown-preview pre.line-numbers .line-numbers-rows>span {
    pointer-events: none;
    display: block;
    counter-increment: linenumber
}

.markdown-preview pre.line-numbers .line-numbers-rows>span:before {
    content: counter(linenumber);
    color: #999;
    display: block;
    padding-right: .8em;
    text-align: right
}

.markdown-preview .mathjax-exps .MathJax_Display {
    text-align: center !important
}

.markdown-preview:not([for="preview"]) .code-chunk .btn-group {
    display: none
}

.markdown-preview:not([for="preview"]) .code-chunk .status {
    display: none
}

.markdown-preview:not([for="preview"]) .code-chunk .output-div {
    margin-bottom: 16px
}

.scrollbar-style::-webkit-scrollbar {
    width: 8px
}

.scrollbar-style::-webkit-scrollbar-track {
    border-radius: 10px;
    background-color: transparent
}

.scrollbar-style::-webkit-scrollbar-thumb {
    border-radius: 5px;
    background-color: rgba(150, 150, 150, 0.66);
    border: 4px solid rgba(150, 150, 150, 0.66);
    background-clip: content-box
}

html body[for="html-export"]:not([data-presentation-mode]) {
    position: relative;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    margin: 0;
    padding: 0;
    overflow: auto
}

html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview {
    position: relative;
    top: 0
}

@media screen and (max-width:450px) {
    html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview {
        font-size: 12px !important;
    }
}

@media print {
    html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn {
        display: none
    }
}

html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn {
    position: fixed;
    bottom: 8px;
    right: 8px;
    font-size: 28px;
    cursor: pointer;
    color: inherit;
    z-index: 99;
    width: 32px;
    text-align: center;
    opacity: .4
}

html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn {
    opacity: 1
}

html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc {
    position: fixed;
    top: 0;
    right: 0;
    width: 300px;
    height: 100%;
    padding: 32px 0 48px 0;
    font-size: 12px;
    border-left: 1px dashed #DDDDDD;
    box-sizing: border-box;
    overflow: auto;
    background-color: inherit
}

html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar {
    width: 8px
}

html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track {
    border-radius: 10px;
    background-color: transparent
}

html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb {
    border-radius: 5px;
    background-color: rgba(150, 150, 150, 0.66);
    border: 4px solid rgba(150, 150, 150, 0.66);
    background-clip: content-box
}

html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a {
    text-decoration: none
}

html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul {
    padding: 0 1.6em;
    margin-top: .8em
}

html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc li {
    margin-bottom: .8em
}

html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul {
    list-style-type: none
}

@media screen and (max-width:1274px) {
    html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview {
        padding: 0em
    }
}

@media screen and (max-width:450px) {
    html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview {
        width: 100%
    }
}

html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc {
    display: none
}

@media screen and (max-width:914px) {
    html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview {
        width: 100%
    }
}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */

      </style>
    </head>
    <body for="html-export">
      <div class="mume markdown-preview  ">
      <h2><a href="http://Please-stop-calling-databases-CP-or-AP.md">Please-stop-calling-databases-CP-or-AP.md</a></h2>
<ul>
<li>@original-name  Please-stop-calling-databases-CP-or-AP</li>
<li>@original-link  <a href="https://martin.kleppmann.com/2015/05/11/please-stop-calling-databases-cp-or-ap.html">https://martin.kleppmann.com/2015/05/11/please-stop-calling-databases-cp-or-ap.html</a></li>
<li>@original-author <a href="https://martin.kleppmann.com/">Martin Kleppmann</a>.</li>
<li>@name       &#x8BF7;&#x4E0D;&#x8981;&#x7EE7;&#x7EED;&#x5C06;&#x6570;&#x636E;&#x5E93;&#x79F0;&#x4E3A;  CP &#x6216; AP</li>
<li>@author     karminski &lt;<a href="mailto:code.karminski@outlook.com">code.karminski@outlook.com</a>&gt;</li>
<li>@version    20190117:1</li>
<li>&#x8BE5;&#x8BD1;&#x6587;&#x5DF2;&#x5F97;&#x5230;&#x539F;&#x4F5C;&#x8005;Martin Kleppmann&#x8BB8;&#x53EF;, &#x5982;&#x9700;&#x8981;&#x8BF7;&#x6C42;&#x8BB8;&#x53EF;&#x6765;&#x6E90;&#x8BF7;&#x76F4;&#x63A5;&#x8054;&#x7CFB;&#x6211;.</li>
<li>&#x672C;&#x6587;&#x7981;&#x6B62;&#x8F6C;&#x8F7D;.</li>
</ul>
<h1 class="mume-header" id="%E8%AF%B7%E4%B8%8D%E8%A6%81%E7%BB%A7%E7%BB%AD%E5%B0%86%E6%95%B0%E6%8D%AE%E5%BA%93%E7%A7%B0%E4%B8%BA-cp-%E6%88%96-ap">&#x8BF7;&#x4E0D;&#x8981;&#x7EE7;&#x7EED;&#x5C06;&#x6570;&#x636E;&#x5E93;&#x79F0;&#x4E3A;  CP &#x6216; AP</h1>

<p>&#x8FD9;&#x7BC7; blog &#x5DF2;&#x88AB;&#x7FFB;&#x8BD1;&#x6210; <a href="https://habrahabr.ru/post/258145/">&#x4FC4;&#x8BED;</a>, <a href="http://suzuki79.hatenablog.com/entry/2017/11/24/222827">&#x65E5;&#x8BED;</a> &#x548C; <a href="https://blog.the-pans.com/cap/">&#x4E2D;&#x6587;</a>.<br>
&#x6709;&#x5173; CAP &#x95EE;&#x9898;&#x7684;&#x66F4;&#x591A;&#x7EC6;&#x8282;&#x548C;&#x5176;&#x4ED6;&#x9009;&#x62E9;&#x65B9;&#x6848;&#x7684;&#x5EFA;&#x8BAE;, &#x8BF7;&#x9605;&#x8BFB;&#x6211;&#x7684;&#x8BBA;&#x6587; <a href="https://arxiv.org/abs/1509.05393">A Critique of the CAP Theorem</a>.</p>
<p>Jeff Hodges &#x5728;&#x4ED6;&#x90A3;&#x7BC7;&#x6770;&#x51FA;&#x7684; blog &#x6587;&#x7AE0; &quot;Distributed Systems for Young Bloods&quot; &#x4E2D;&#x5EFA;&#x8BAE;&#x7528; CAP &#x5B9A;&#x7406;&#x6765;&#x8BC4;&#x5224;&#x4E00;&#x4E2A;&#x7CFB;&#x7EDF;.<br>
&#x8FD9;&#x7684;&#x786E;&#x5F88;&#x6DF1;&#x5165;&#x4EBA;&#x5FC3;, &#x4EE5;&#x81F3;&#x4E8E;&#x8FD9;&#x4E9B;&#x4EBA;&#x76F4;&#x63A5;&#x5C06;&#x4ED6;&#x4EEC;&#x7684;&#x7CFB;&#x7EDF;&#x63CF;&#x8FF0;&#x4E3A;<br>
&quot;CP&quot; (consistent but not available under network partitions, &#x4E00;&#x81F4;&#x4F46;&#x5728;&#x7F51;&#x7EDC;&#x5206;&#x533A;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x4E0D;&#x53EF;&#x7528;),<br>
&quot;AP&quot; (available but not consistent under network partitions, &#x53EF;&#x7528;&#x4F46;&#x5728;&#x7F51;&#x7EDC;&#x5206;&#x533A;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x4E0D;&#x4E00;&#x81F4;),<br>
&#x6216; &quot;CA&quot; (meaning &quot;I still haven&#x2019;t read <a href="https://codahale.com/you-cant-sacrifice-partition-tolerance/">Coda&apos;s post from almost 5 years Ago</a>&quot;, &#x8FD8;&#x6CA1;&#x6709;&#x8BFB;&#x8FC7; Coda &#x7684;5&#x5E74;&#x524D;&#x7684;&#x90A3;&#x7BC7;&#x6587;&#x7AE0;).</p>
<p>&#x6211;&#x540C;&#x610F; Jeff &#x7684;&#x6240;&#x6709;&#x5176;&#x4ED6;&#x89C2;&#x70B9;, &#x4F46;&#x5173;&#x4E8E; CAP &#x5B9A;&#x7406;, &#x6211;&#x6301;&#x6709;&#x4E0D;&#x540C;&#x610F;&#x89C1;.  CAP &#x5B9A;&#x7406;&#x8FC7;&#x4E8E;&#x7CBE;&#x7B80;, &#x4E14;&#x88AB;&#x5E7F;&#x6CDB;&#x8BEF;&#x89E3;, &#x5BFC;&#x81F4;&#x5B83;&#x5BF9;&#x63CF;&#x8FF0;&#x4E00;&#x4E2A;&#x7CFB;&#x7EDF;&#x6CA1;&#x6709;&#x591A;&#x5927;&#x7528;&#x5904;.<br>
&#x6240;&#x4EE5;&#x6211;&#x6073;&#x8BF7;&#x5927;&#x5BB6;&#x6700;&#x597D;&#x8FD8;&#x662F;&#x653E;&#x5F03; CAP &#x5B9A;&#x7406;&#x5E76;&#x505C;&#x6B62;&#x5F15;&#x7528;&#x548C;&#x8BA8;&#x8BBA;. &#x5E76;&#x4E14;&#x6211;&#x4EEC;&#x8981;&#x7528;&#x66F4;&#x7CBE;&#x786E;&#x7684;&#x672F;&#x8BED;&#x6765;&#x6743;&#x8861;&#x7CFB;&#x7EDF;.</p>
<p>(&#x6211;&#x77E5;&#x9053;&#x6211;&#x5199;&#x8FD9;&#x7BC7; blog &#x662F;&#x5728;&#x8BBD;&#x523A;&#x4F60;&#x4EEC;, &#x4F46;&#x81F3;&#x5C11;&#x8FD9;&#x6837;&#x6211;&#x5C31;&#x6709;&#x4E86;&#x4E2A; URL, &#x5F53;&#x522B;&#x4EBA;&#x95EE;&#x4E3A;&#x4EC0;&#x4E48;&#x6211;&#x4E0D;&#x559C;&#x6B22;&#x4ED6;&#x4EEC;&#x8C08;&#x8BBA; CAP &#x5B9A;&#x7406;&#x7684;&#x65F6;&#x5019;&#x6211;&#x5C31;&#x53EF;&#x4EE5;&#x7529;&#x7ED9;&#x4ED6;&#x4EEC;. &#x53E6;&#x5916;&#x6211;&#x5F88;&#x62B1;&#x6B49;&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#x50CF;&#x662F;&#x5728;&#x5BF9;&#x4F60;&#x4EEC;&#x543C;, &#x4F46;&#x8D77;&#x7801;&#x6211;&#x543C;&#x7684;&#x6709;&#x7406;&#x6709;&#x636E;(lots of literature references)).</p>
<h3 class="mume-header" id="cap-%E5%AE%9A%E4%B9%89%E9%9D%9E%E5%B8%B8%E7%8B%AD%E9%9A%98">CAP &#x5B9A;&#x4E49;&#x975E;&#x5E38;&#x72ED;&#x9698;</h3>

<p>&#x5982;&#x679C;&#x60F3;&#x5C06; CAP &#x79F0;&#x4E3A;&#x4E00;&#x4E2A;&#x5B9A;&#x7406; (&#x800C;&#x4E0D;&#x662F;&#x6570;&#x636E;&#x5E93;&#x8F6F;&#x6587;&#x4E2D;&#x6A21;&#x7CCA;&#x7684;&#x7F3A;&#x4E4F;&#x652F;&#x6491;&#x7684;&#x6982;&#x5FF5;) &#x90A3;&#x5C31;&#x5FC5;&#x987B;&#x8981;&#x7CBE;&#x786E;.<br>
&#x6570;&#x5B66;&#x662F;&#x4E25;&#x8C28;&#x7684;&#x79D1;&#x5B66;. &#x5728;<a href="http://webpages.cs.luc.edu/~pld/353/gilbert_lynch_brewer_proof.pdf">&#x8BC1;&#x660E;&#x8FC7;&#x7A0B;</a>&#x4E2D;&#x4F7F;&#x7528;&#x7684;&#x8BCD;&#x8BED;&#x5FC5;&#x987B;&#x542B;&#x4E49;&#x76F8;&#x540C;, &#x8BC1;&#x660E;&#x624D;&#x80FD;&#x6210;&#x7ACB;.<br>
&#x4F46;&#x5728;&#x8BC1;&#x660E;&#x4E2D;, &#x8FD9;&#x4E9B;&#x5B9A;&#x4E49;&#x90FD;&#x662F;&#x4E00;&#x4E9B;&#x7279;&#x6B8A;&#x573A;&#x666F;, &#x4F8B;&#x5982;:</p>
<ul>
<li>
<p>&#x4E00;&#x81F4;&#x6027; (Consistency) &#x5728; CAP &#x4E2D;&#x5176;&#x5B9E;&#x662F; &#x7EBF;&#x6027;&#x4E00;&#x81F4;&#x6027; (linearizability), &#x7EBF;&#x6027;&#x4E00;&#x81F4;&#x6027;&#x662F;&#x975E;&#x5E38;&#x7279;&#x5B9A; (&#x4E14;&#x975E;&#x5E38;&#x5F3A; Strong) &#x7684;&#x4E00;&#x81F4;&#x6027;&#x6982;&#x5FF5;.<br>
&#x800C;&#x4E14;&#x4ED6;&#x8DDF; ACID &#x4E2D;&#x7684; C &#x662F;&#x65E0;&#x5173;&#x7684;, &#x5C3D;&#x7BA1;&#x8FD9;&#x4E2A; C &#x4E5F;&#x4EE3;&#x8868; &quot;&#x4E00;&#x81F4;&#x6027;&quot; (consistency). &#x6211;&#x63A5;&#x4E0B;&#x6765;&#x4F1A;&#x89E3;&#x91CA;&#x4EC0;&#x4E48;&#x662F;&#x7EBF;&#x6027;&#x4E00;&#x81F4;&#x6027; (linearizability).</p>
</li>
<li>
<p>&#x53EF;&#x7528;&#x6027; (Availability) &#x5728; CAP &#x4E2D;&#x5B9A;&#x4E49;&#x4E3A; &quot;&#x7CFB;&#x7EDF;&#x4E2D;&#x7684;&#x975E;&#x6545;&#x969C;(&#x6570;&#x636E;&#x5E93;)&#x8282;&#x70B9;&#x9488;&#x5BF9;&#x6536;&#x5230;&#x7684;&#x6BCF;&#x4E2A;&#x8BF7;&#x6C42;&#x5FC5;&#x987B;&#x505A;&#x51FA;[&#x975E;&#x9519;&#x8BEF;]&#x54CD;&#x5E94;&quot;. &#x8FD9;&#x91CC;&#x7684;&#x95EE;&#x9898;&#x5728;&#x4E8E;, &#x67D0;&#x4E2A;&#x8282;&#x70B9;&#x80FD;&#x591F;&#x5904;&#x7406;&#x8BF7;&#x6C42;&#x662F;&#x4E0D;&#x591F;&#x7684;, &#x4EFB;&#x4F55;&#x975E;&#x6545;&#x969C;&#x8282;&#x70B9;&#x90FD;&#x8981;&#x80FD;&#x591F;&#x5904;&#x7406;&#x8BF7;&#x6C42;.<br>
&#x8BB8;&#x591A;&#x6240;&#x8C13;&#x7684; &quot;&#x9AD8;&#x53EF;&#x7528;&quot; (&#x5373;&#x4F4E;&#x505C;&#x673A;&#x65F6;&#x95F4;) &#x7CFB;&#x7EDF;&#x90FD;&#x4E0D;&#x7B26;&#x5408;&#x8FD9;&#x79CD;&#x53EF;&#x7528;&#x6027;&#x7684;&#x5B9A;&#x4E49;.</p>
</li>
<li>
<p>&#x5206;&#x533A;&#x5BB9;&#x9519;&#x6027; (Partition Tolerance)(&#x975E;&#x5E38;&#x9519;&#x8BEF;&#x7684;&#x540D;&#x79F0;) &#x57FA;&#x672C;&#x4E0A;&#x610F;&#x5473;&#x7740;&#x4F60;&#x7684;&#x901A;&#x4FE1;&#x5EFA;&#x7ACB;&#x5728;&#x53EF;&#x80FD;&#x4F1A;&#x5EF6;&#x8FDF;&#x6216;&#x4E22;&#x5305;&#x7684;&#x5F02;&#x6B65;&#x901A;&#x4FE1;&#x7F51;&#x7EDC;&#x4E0A;. &#x4E92;&#x8054;&#x7F51;&#x548C;&#x6211;&#x4EEC;&#x7684;&#x6570;&#x636E;&#x4E2D;&#x5FC3;&#x90FD;&#x6709;&#x8FD9;&#x4E2A;&#x5C5E;&#x6027;, &#x6240;&#x4EE5;&#x5728;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x4E0A;&#x5176;&#x5B9E;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x9009;&#x62E9;.</p>
</li>
</ul>
<p>&#x800C;&#x4E14;&#x8FD8;&#x8981;&#x6CE8;&#x610F; CAP &#x5B9A;&#x7406;&#x4E0D;&#x4EC5;&#x63CF;&#x8FF0;&#x7684;&#x662F;&#x4E2A;&#x65E7;&#x7684;&#x7CFB;&#x7EDF;, &#x800C;&#x4E14;&#x662F;&#x4E00;&#x4E2A;&#x975E;&#x5E38;&#x7279;&#x5B9A;&#x7684;&#x7CFB;&#x7EDF;:</p>
<ul>
<li>
<p>CAP &#x662F;&#x4E00;&#x4E2A;&#x5355;&#x4E00;&#x8BFB;&#x5199;&#x5BC4;&#x5B58;&#x5668; (single, read-write register) &#x7CFB;&#x7EDF;&#x6A21;&#x578B;. &#x4F8B;&#x5982;, CAP&#x5B9A;&#x7406;&#x6CA1;&#x6709;&#x8BF4;&#x660E;&#x6D89;&#x53CA;&#x591A;&#x4E2A;&#x5BF9;&#x8C61;&#x7684;&#x4E8B;&#x52A1;, &#x56E0;&#x4E3A;&#x8FD9;&#x8D85;&#x51FA;&#x4E86;&#x5B9A;&#x7406;&#x8303;&#x56F4;. &#x9664;&#x975E;&#x80FD;&#x628A;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x7CBE;&#x7B80;&#x5230;&#x5355;&#x5BC4;&#x5B58;&#x5668;.</p>
</li>
<li>
<p>CAP &#x5B9A;&#x7406;&#x8003;&#x8651;&#x7684;&#x552F;&#x4E00;&#x6545;&#x969C;&#x573A;&#x666F;&#x662F;&#x7F51;&#x7EDC;&#x5206;&#x533A; (network partition, &#x5373;&#x8282;&#x70B9;&#x4FDD;&#x6301;&#x8FD0;&#x884C;, &#x4F46;&#x662F;&#x8282;&#x70B9;&#x6240;&#x5728;&#x7684;&#x90E8;&#x5206;&#x7F51;&#x7EDC;&#x65E0;&#x6CD5;&#x901A;&#x4FE1;&#x4EA7;&#x751F;&#x4E86;&#x5206;&#x533A;). &#x8FD9;&#x79CD;&#x6545;&#x969C;&#x7EDD;&#x5BF9;&#x4F1A;&#x53D1;&#x751F;, &#x4F46;&#x7EDD;&#x4E0D;&#x662F;&#x552F;&#x4E00;&#x4F1A;&#x53D1;&#x751F;&#x7684;&#x6545;&#x969C;:<br>
&#x8282;&#x70B9;&#x53EF;&#x80FD;&#x4F1A;&#x5D29;&#x6E83;&#x6216;&#x88AB;&#x91CD;&#x542F;, &#x53EF;&#x80FD;&#x9047;&#x5230;&#x78C1;&#x76D8;&#x7A7A;&#x95F4;&#x4E0D;&#x8DB3;, &#x53EF;&#x80FD;&#x9047;&#x5230;&#x8F6F;&#x4EF6;&#x4E2D;&#x7684;bug, &#x7B49;&#x7B49;&#x6545;&#x969C;. &#x5728;&#x6784;&#x5EFA;&#x5206;&#x5E03;&#x5F0F;&#x7CFB;&#x7EDF;&#x4E2D;, &#x9700;&#x8981;&#x8003;&#x8651;&#x66F4;&#x5927;&#x8303;&#x56F4;&#x7684;&#x53D6;&#x820D;, &#x8FC7;&#x5EA6;&#x5173;&#x6CE8; CAP &#x5B9A;&#x7406;&#x5219;&#x4F1A;&#x8BA9;&#x4F60;&#x5FFD;&#x89C6;&#x5176;&#x4ED6;&#x91CD;&#x8981;&#x7684;&#x95EE;&#x9898;.</p>
</li>
<li>
<p>&#x6B64;&#x5916;, CAP &#x5B9A;&#x7406;&#x5B8C;&#x5168;&#x6CA1;&#x6709;&#x63D0;&#x5230;&#x5EF6;&#x8FDF; (latency), &#x5927;&#x5BB6;&#x5173;&#x6CE8;&#x7684;&#x53EF;&#x4E0D;&#x4EC5;&#x4EC5;&#x662F;&#x53EF;&#x7528;&#x6027;. &#x5B9E;&#x9645;&#x4E0A;, CAP &#x53EF;&#x7528;&#x7684;&#x7CFB;&#x7EDF;&#x5141;&#x8BB8;&#x54CD;&#x5E94;&#x65E0;&#x9650;&#x6162;, &#x5E76;&#x4E14;&#x8FD9;&#x6837;&#x4ECD;&#x7136;&#x53EF;&#x4EE5;&#x79F0;&#x4F5C; &quot;&#x53EF;&#x7528;&quot; (available). &#x5982;&#x679C;&#x52A0;&#x8F7D;&#x4E00;&#x4E2A;&#x9875;&#x9762;&#x8981;2&#x5206;&#x949F;, &#x7528;&#x6237;&#x53EF;&#x5C31;&#x4E0D;&#x4F1A;&#x8BA4;&#x4E3A;&#x4F60;&#x7684;&#x7CFB;&#x7EDF; &quot;&#x53EF;&#x7528;&quot;&#x4E86;.</p>
</li>
</ul>
<p>&#x5982;&#x679C;&#x4F60;&#x4F7F;&#x7528;&#x7684;&#x76F8;&#x5173;&#x5B9A;&#x4E49;&#x4E0E;&#x4E0A;&#x9762;&#x63CF;&#x8FF0;&#x7684;&#x5173;&#x4E8E; CAP &#x7684;&#x5B9A;&#x4E49;&#x7CBE;&#x786E;&#x76F8;&#x7B26;, &#x5219; CAP &#x5B9A;&#x7406;&#x9002;&#x5408;&#x4F60;. &#x4E0D;&#x8FC7;&#x5982;&#x679C;&#x4F7F;&#x7528;&#x5176;&#x4ED6;&#x7684;&#x4E00;&#x81F4;&#x6027;&#x6216;&#x53EF;&#x7528;&#x6027;&#x7684;&#x6982;&#x5FF5;, &#x5C31;&#x4E0D;&#x80FD;&#x671F;&#x5F85; CAP &#x5B9A;&#x7406;&#x4ECD;&#x7136;&#x9002;&#x7528;.<br>
&#x5F53;&#x7136;&#x8FD9;&#x5E76;&#x4E0D;&#x610F;&#x5473;&#x7740;&#x91CD;&#x65B0;&#x5B9A;&#x4E49;&#x4E00;&#x4E9B;&#x8BCD;&#x6C47;&#x5C31;&#x8D85;&#x8131;&#x73B0;&#x5B9E;, &#x800C;&#x662F;&#x8BF4;&#x4E0D;&#x80FD;&#x628A; CAP &#x5B9A;&#x7406;&#x4F5C;&#x4E3A;&#x6307;&#x5BFC;, &#x800C;&#x4E14;&#x4E0D;&#x8981;&#x7528; CAP &#x5B9A;&#x7406;&#x6765;&#x8BC1;&#x660E;&#x4F60;&#x7684;&#x89C2;&#x70B9;.</p>
<p>&#x5982;&#x679C;CAP&#x5B9A;&#x7406;&#x4E0D;&#x9002;&#x7528;, &#x90A3;&#x5C31;&#x610F;&#x5473;&#x7740;&#x4F60;&#x5FC5;&#x987B;&#x81EA;&#x5DF1;&#x53BB;&#x8003;&#x8651;&#x7CFB;&#x7EDF;&#x4E2D;&#x7684;&#x6743;&#x8861;&#x6761;&#x4EF6;. &#x4F60;&#x53EF;&#x4EE5;&#x81EA;&#x5DF1;&#x5B9A;&#x4E49;&#x4E00;&#x81F4;&#x6027;&#x548C;&#x53EF;&#x7528;&#x6027;, &#x5E76;&#x4E14;&#x8BC1;&#x660E;&#x4F60;&#x7684;&#x5B9A;&#x7406;. &#x4F46;&#x4E0D;&#x8981;&#x53EB; CAP &#x5B9A;&#x7406;&#x4E86;, &#x56E0;&#x4E3A;&#x5DF2;&#x7ECF;&#x88AB;&#x5360;&#x7528;&#x4E86;.</p>
<h3 class="mume-header" id="%E7%BA%BF%E6%80%A7%E4%B8%80%E8%87%B4%E6%80%A7-linearizability">&#x7EBF;&#x6027;&#x4E00;&#x81F4;&#x6027; (Linearizability)</h3>

<p>&#x5982;&#x679C;&#x4F60;&#x4E0D;&#x719F;&#x6089; &#x7EBF;&#x6027;&#x4E00;&#x81F4;&#x6027; (Linearizability, &#x5373; CAP &#x610F;&#x4E49;&#x4E0A;&#x7684; &quot;&#x4E00;&#x81F4;&#x6027;, consistency&quot;). &#x7B80;&#x8981;&#x7684;&#x89E3;&#x91CA;&#x4E00;&#x4E0B;, &#x6B63;&#x5F0F;&#x7684;&#x5B9A;&#x4E49;&#x5E76;&#x4E0D;&#x662F;&#x5341;&#x5206;&#x7684;&#x76F4;&#x622A;&#x4E86;&#x5F53;, &#x4E0D;&#x8FC7;&#x5B9A;&#x4E49;&#x7684;&#x6838;&#x5FC3;&#x7B80;&#x5355;&#x6765;&#x8BB2;&#x662F;:</p>
<blockquote>
<p>&#x5982;&#x679C;&#x64CD;&#x4F5C; A &#x6210;&#x529F;&#x5B8C;&#x6210;, &#x8FDB;&#x884C;&#x64CD;&#x4F5C; B, &#x90A3;&#x4E48;&#x64CD;&#x4F5C; B &#x5FC5;&#x987B;&#x89C2;&#x5BDF;&#x5230;&#x7CFB;&#x7EDF;&#x5904;&#x4E8E;&#x64CD;&#x4F5C; A &#x5B8C;&#x6210;, &#x6216;&#x66F4;&#x65B0;&#x5B8C;&#x6BD5;&#x7684;&#x7EDF;&#x4E00;&#x72B6;&#x6001;.</p>
</blockquote>
<p>&#x4E3A;&#x4E86;&#x66F4;&#x5177;&#x4F53;, &#x8003;&#x8651;&#x4E00;&#x4E2A;&#x975E;&#x7EBF;&#x6027;&#x5316;&#x7684;&#x7CFB;&#x7EDF;, &#x89C1;&#x4E0B;&#x56FE; (&#x8FD9;&#x4E2A;&#x56FE;&#x51FA;&#x81EA;&#x6211;&#x672A;&#x53D1;&#x5E03;&#x7684;&#x4E66;&#x4E2D;):</p>
<p><img src="./assets/images/linearizability.png" alt="linearizability"></p>
<p>&#x8BE5;&#x56FE;&#x663E;&#x793A;&#x4E86;&#x4F4D;&#x4E8E;&#x540C;&#x4E00;&#x623F;&#x95F4;&#x7684; Alice &#x548C; Bob, &#x4ED6;&#x4FE9;&#x90FD;&#x5728;&#x5237;&#x624B;&#x673A;&#x770B; 2014 &#x8DB3;&#x7403;&#x4E16;&#x754C;&#x676F;&#x7684;&#x51B3;&#x8D5B;&#x7ED3;&#x679C;.  &#x5728;&#x6700;&#x7EC8;&#x6BD4;&#x5206;&#x516C;&#x5E03;&#x540E;, Alice &#x5237;&#x65B0;&#x9875;&#x9762;, &#x5174;&#x594B;&#x5730;&#x544A;&#x8BC9; Bob &#x83B7;&#x80DC;&#x8005;&#x5DF2;&#x7ECF;&#x516C;&#x5E03;&#x4E86;.<br>
Bob &#x534A;&#x4FE1;&#x534A;&#x7591;&#x7684;&#x5237;&#x65B0;&#x81EA;&#x5DF1;&#x624B;&#x673A;&#x4E0A;&#x7684;&#x9875;&#x9762;, &#x4F46;&#x662F;&#x4ED6;&#x7684;&#x8BF7;&#x6C42;&#x88AB;&#x8F6C;&#x53D1;&#x5230;&#x4E86;&#x4E00;&#x4E2A;&#x6EDE;&#x540E;&#x7684;&#x6570;&#x636E;&#x5E93;&#x526F;&#x672C; (database replica), &#x6240;&#x4EE5;&#x4ED6;&#x7684;&#x624B;&#x673A;&#x4E0A;&#x663E;&#x793A;&#x6BD4;&#x8D5B;&#x4ECD;&#x5728;&#x7EE7;&#x7EED;.</p>
<p>&#x5047;&#x5982; Alice &#x548C; Bob &#x540C;&#x65F6;&#x91CD;&#x65B0;&#x52A0;&#x8F7D;, &#x90A3;&#x4E48;&#x4ED6;&#x4EEC;&#x5F97;&#x5230;&#x4E86;&#x4E24;&#x4E2A;&#x4E0D;&#x540C;&#x7684;&#x67E5;&#x8BE2;&#x7ED3;&#x679C;&#x4E5F;&#x662F;&#x6709;&#x53EF;&#x80FD;&#x7684;, &#x56E0;&#x4E3A;&#x4ED6;&#x4EEC;&#x4E0D;&#x77E5;&#x9053;&#x670D;&#x52A1;&#x5668;&#x5904;&#x7406;&#x4ED6;&#x4EEC;&#x5404;&#x81EA;&#x7684;&#x8BF7;&#x6C42;&#x7684;&#x786E;&#x5207;&#x65F6;&#x95F4;.<br>
&#x7136;&#x800C;, Bob &#x662F;&#x5728;&#x542C;&#x5230; Alice &#x60CA;&#x53F9;&#x6700;&#x7EC8;&#x6BD4;&#x5206;&#x540E;&#x624D;&#x70B9;&#x51FB;&#x4E86;&#x91CD;&#x65B0;&#x52A0;&#x8F7D;&#x6309;&#x94AE; (&#x53D1;&#x8D77;&#x4ED6;&#x7684;&#x67E5;&#x8BE2;), &#x56E0;&#x6B64;&#x4ED6;&#x5E0C;&#x671B;&#x4ED6;&#x7684;&#x67E5;&#x8BE2;&#x7ED3;&#x679C;&#x81F3;&#x5C11;&#x4E0E; Alice &#x7684;&#x4E00;&#x6837;, &#x7136;&#x800C;&#x5374;&#x5F97;&#x5230;&#x4E86;&#x65E7;&#x7684;&#x67E5;&#x8BE2;&#x7ED3;&#x679C;, &#x8FD9;&#x4E00;&#x4E8B;&#x5B9E;&#x8FDD;&#x53CD;&#x4E86;&#x7EBF;&#x6027;&#x4E00;&#x81F4;&#x6027; (Linearizability).</p>
<p>Bob &#x7684;&#x8BF7;&#x6C42;&#x4E25;&#x683C;&#x5730;&#x53D1;&#x751F;&#x5728; Alice &#x7684;&#x8BF7;&#x6C42;&#x4E4B;&#x540E; (&#x5373;&#x5B83;&#x4EEC;&#x4E0D;&#x662F;&#x5E76;&#x53D1;&#x7684;), &#x662F;&#x56E0;&#x4E3A; Bob &#x901A;&#x8FC7;&#x4E00;&#x4E2A;&#x5355;&#x72EC;&#x7684;&#x901A;&#x4FE1;&#x901A;&#x9053; (&#x672C;&#x4F8B;&#x4E2D;&#x662F;&#x73B0;&#x5B9E;&#x4E16;&#x754C;&#x7684;&#x58F0;&#x97F3;) &#x542C;&#x5230; Alice &#x7684;&#x67E5;&#x8BE2;&#x7ED3;&#x679C;.<br>
&#x5982;&#x679C; Bob &#x6CA1;&#x6709;&#x4ECE; Alice &#x90A3;&#x91CC;&#x542C;&#x8BF4;&#x6BD4;&#x8D5B;&#x7ED3;&#x675F;&#x4E86;, &#x4ED6;&#x5C31;&#x4E0D;&#x4F1A;&#x77E5;&#x9053;&#x4ED6;&#x7684;&#x67E5;&#x8BE2;&#x7ED3;&#x679C;&#x5DF2;&#x7ECF;&#x8FC7;&#x671F;&#x4E86;.</p>
<p>&#x5982;&#x679C;&#x4F60;&#x6B63;&#x5728;&#x6784;&#x5EFA;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x5E93;, &#x662F;&#x65E0;&#x6CD5;&#x77E5;&#x9053;&#x5BA2;&#x6237;&#x7AEF;&#x53EF;&#x80FD;&#x6709;&#x54EA;&#x4E9B;&#x5176;&#x4ED6;&#x901A;&#x4FE1;&#x6E20;&#x9053; (backchannel) &#x7684;.<br>
&#x56E0;&#x6B64;, &#x5982;&#x679C;&#x5E0C;&#x671B;&#x5728;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x63D0;&#x4F9B;&#x7EBF;&#x6027;&#x8BED;&#x4E49; (linearizable semantics &#x5373;CAP&#x4E2D;&#x7684;consistency), &#x5C31;&#x9700;&#x8981;&#x8BA9;&#x6570;&#x636E;&#x770B;&#x8D77;&#x6765;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x526F;&#x672C;, &#x5373;&#x4F7F;&#x6570;&#x636E;&#x53EF;&#x80FD;&#x5728;&#x591A;&#x4E2A;&#x4F4D;&#x7F6E;&#x6709;&#x591A;&#x4E2A;&#x526F;&#x672C; (replicas, caches).</p>
<p>&#x5B9E;&#x73B0;&#x8FD9;&#x6837;&#x7684;&#x4FDD;&#x969C;&#x975E;&#x5E38;&#x56F0;&#x96BE;, &#x56E0;&#x4E3A;&#x5B83;&#x9700;&#x8981;&#x5927;&#x91CF;&#x7684;&#x534F;&#x8C03;.<br>
&#x751A;&#x81F3;&#x8BA1;&#x7B97;&#x673A;&#x4E2D;&#x7684; CPU &#x90FD;<a href="https://www.cl.cam.ac.uk/~pes20/weakmemory/x86tso-paper.tphols.pdf">&#x4E0D;&#x80FD;&#x63D0;&#x4F9B;&#x5BF9;&#x672C;&#x5730;&#x5185;&#x5B58;&#x7684;&#x7EBF;&#x6027;&#x8BBF;&#x95EE;!</a> &#x5728;&#x73B0;&#x4EE3; CPU &#x4E0A;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x663E;&#x5F0F;&#x5185;&#x5B58;&#x5C4F;&#x969C;&#x6307;&#x4EE4; (explicit <a href="http://mechanical-sympathy.blogspot.co.uk/2011/07/memory-barriersfences.html">memory barrier instruction</a>) &#x624D;&#x80FD;&#x7EBF;&#x6027;&#x8BBF;&#x95EE;. &#x751A;&#x81F3;&#x6D4B;&#x8BD5;&#x4E00;&#x4E2A;&#x7CFB;&#x7EDF;&#x662F;&#x5426;&#x80FD;&#x63D0;&#x4F9B;&#x7EBF;&#x6027;&#x8BBF;&#x95EE;&#x4E5F;&#x662F;&#x5F88;<a href="https://github.com/aphyr/knossos">&#x68D8;&#x624B;</a>&#x7684;.</p>
<h3 class="mume-header" id="cap-availability">CAP-Availability</h3>

<p>&#x8BA9;&#x6211;&#x4EEC;&#x7B80;&#x5355;&#x5730;&#x8BA8;&#x8BBA;&#x4E0B;&#x5728;&#x7F51;&#x7EDC;&#x5206;&#x533A; (network partition) &#x60C5;&#x51B5;&#x4E0B;&#x653E;&#x5F03;&#x7EBF;&#x6027;&#x4E00;&#x81F4;&#x6027; (linearizability) &#x6216;&#x53EF;&#x7528;&#x6027; (availability) &#x7684;&#x5FC5;&#x8981;&#x6027;.</p>
<p>&#x5047;&#x8BBE;&#x5728;&#x4E24;&#x4E2A;&#x4E0D;&#x540C;&#x7684;&#x6570;&#x636E;&#x4E2D;&#x5FC3;&#x4E2D;&#x90FD;&#x6709;&#x6570;&#x636E;&#x5E93;&#x7684;&#x526F;&#x672C; (replicas). &#x6570;&#x636E;&#x590D;&#x5236;&#x7684;&#x786E;&#x5207;&#x65B9;&#x6CD5;&#x76EE;&#x524D;&#x5E76;&#x4E0D;&#x91CD;&#x8981; - &#x5B83;&#x53EF;&#x80FD;&#x662F;&#x5355;&#x4E3B; (&#x4E3B;/&#x4ECE;, master/slave), &#x591A;&#x4E3B; (&#x4E3B;/&#x4E3B;, master/master) &#x6216;&#x57FA;&#x4E8E; quorum (&#x5373;&#x8282;&#x70B9;&#x9009;&#x4E3E;&#x5236;) &#x7684;&#x526F;&#x672C; (&#x7C7B;&#x4F3C; <a href="https://www.allthingsdistributed.com/files/amazon-dynamo-sosp2007.pdf">Amazon Dynamo</a>).<br>
&#x526F;&#x672C;&#x7684;&#x8981;&#x6C42;&#x662F;, &#x5728;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x4E2D;&#x5FC3;&#x4E2D;&#x5199;&#x5165;&#x6570;&#x636E;&#x7684;&#x540C;&#x65F6;, &#x90FD;&#x5FC5;&#x987B;&#x5C06;&#x6570;&#x636E;&#x5199;&#x5165;&#x53E6;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x4E2D;&#x5FC3;&#x4E2D;&#x7684;&#x526F;&#x672C;.<br>
&#x5047;&#x8BBE;&#x5BA2;&#x6237;&#x7AEF;&#x53EA;&#x8FDE;&#x63A5;&#x5230;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x4E2D;&#x5FC3;, &#x90A3;&#x4E48;&#x5F53;&#x6570;&#x636E;&#x590D;&#x5236;&#x7684;&#x65F6;&#x5019;&#x5C31;&#x5FC5;&#x987B;&#x4F9D;&#x8D56;&#x4E24;&#x4E2A;&#x6570;&#x636E;&#x4E2D;&#x5FC3;&#x4E4B;&#x95F4;&#x7684;&#x7F51;&#x7EDC;&#x94FE;&#x63A5;.</p>
<p>&#x73B0;&#x5728;&#x5047;&#x8BBE;&#x7F51;&#x7EDC;&#x8FDE;&#x63A5;&#x4E2D;&#x65AD; - &#x8FD9;&#x5C31;&#x662F;&#x7F51;&#x7EDC;&#x5206;&#x533A; (network partition) &#x7684;&#x610F;&#x601D;. &#x731C;&#x731C;&#x4F1A;&#x53D1;&#x751F;&#x4EC0;&#x4E48;?</p>
<p><img src="./assets/images/cap-availability.png" alt="cap-availability"></p>
<p>&#x5F88;&#x660E;&#x663E;&#x4F60;&#x53EA;&#x80FD;&#x4E8C;&#x9009;&#x4E00;:</p>
<ol>
<li>
<p>&#x7A0B;&#x5E8F;&#x53EF;&#x4EE5;&#x7EE7;&#x7EED;&#x5199;&#x5165;&#x6570;&#x636E;&#x5E93;, &#x6240;&#x4EE5;&#x4E24;&#x4E2A;&#x6570;&#x636E;&#x4E2D;&#x5FC3;&#x4E2D;&#x6570;&#x636E;&#x5E93;&#x90FD;&#x662F;&#x5B8C;&#x5168;&#x53EF;&#x7528;&#x7684;. &#x4F46;&#x53EA;&#x8981;&#x6570;&#x636E;&#x590D;&#x5236;&#x4F9D;&#x8D56;&#x7684;&#x8FDE;&#x63A5;&#x88AB;&#x4E2D;&#x65AD;, &#x5728;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x4E2D;&#x5FC3;&#x4E2D;&#x5BF9;&#x6570;&#x636E;&#x5E93;&#x7684;&#x66F4;&#x6539;&#x5C06;&#x4E0D;&#x4F1A;&#x540C;&#x6B65;&#x5230;&#x53E6;&#x5916;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x4E2D;&#x5FC3;.<br>
&#x8FD9;&#x8FDD;&#x53CD;&#x4E86;&#x7EBF;&#x6027;&#x4E00;&#x81F4;&#x6027; (linearizability)(&#x5728;&#x524D;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#x4E2D;, Alice &#x53EF;&#x80FD;&#x8FDE;&#x63A5;&#x5230;&#x6570;&#x636E;&#x4E2D;&#x5FC3;1, Bob &#x8FDE;&#x63A5;&#x5230;&#x4E86;&#x6570;&#x636E;&#x4E2D;&#x5FC3;2).</p>
</li>
<li>
<p>&#x5982;&#x679C;&#x4E0D;&#x60F3;&#x5931;&#x53BB;&#x7EBF;&#x6027;&#x4E00;&#x81F4;&#x6027; (linearizability), &#x5C31;&#x5FC5;&#x987B;&#x786E;&#x4FDD;&#x5728;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x4E2D;&#x5FC3;&#x6267;&#x884C;&#x6240;&#x6709;&#x8BFB;&#x5199;&#x64CD;&#x4F5C; (&#x53EF;&#x4EE5;&#x79F0;&#x4F5C;leader), &#x5728;&#x53E6;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x4E2D;&#x5FC3; (&#x7531;&#x4E8E;&#x6570;&#x636E;&#x590D;&#x5236;&#x4F9D;&#x8D56;&#x7684;&#x8FDE;&#x63A5;&#x4E2D;&#x65AD;&#x800C;&#x65E0;&#x6CD5;&#x66F4;&#x65B0;&#x5230;&#x6700;&#x65B0;) &#x5728;&#x7F51;&#x8DEF;&#x5206;&#x533A;&#x6062;&#x590D;&#x6B63;&#x5E38;,&#x6570;&#x636E;&#x540C;&#x6B65;&#x5B8C;&#x6BD5;&#x4E4B;&#x524D;&#x5FC5;&#x987B;&#x505C;&#x6B62;&#x63A5;&#x53D7;&#x8BFB;&#x5199;&#x64CD;&#x4F5C;.<br>
&#x5C3D;&#x7BA1;&#x975E; leader &#x6570;&#x636E;&#x5E93;&#x6CA1;&#x6709;&#x5931;&#x6548; (failed), &#x4F46;&#x4ED6;&#x65E0;&#x6CD5;&#x5904;&#x7406;&#x8BF7;&#x6C42;, &#x56E0;&#x6B64;&#x5B83;&#x4E0D;&#x662F;CAP&#x53EF;&#x7528; (CAP-available) &#x7684;.</p>
</li>
</ol>
<p>(&#x987A;&#x4FBF;&#x8BF4;&#x8FD9;&#x57FA;&#x672C;&#x5C31;&#x662F;&#x5BF9;CAP&#x5B9A;&#x7406;&#x7684;&#x8BC1;&#x660E;&#x4E86;. &#x8FD9;&#x5C31;&#x662F;&#x4ED6;&#x7684;&#x5168;&#x90E8;&#x5185;&#x5BB9;. &#x672C;&#x4F8B;&#x4E2D;&#x4F7F;&#x7528;&#x4E86;2&#x4E2A;&#x6570;&#x636E;&#x4E2D;&#x5FC3;, &#x4F46;&#x8FD9;&#x4E5F;&#x540C;&#x6837;&#x9002;&#x7528;&#x4E8E;&#x5355;&#x4E00;&#x6570;&#x636E;&#x4E2D;&#x5FC3;&#x4E2D;&#x7684;&#x7F51;&#x8DEF;&#x95EE;&#x9898;. &#x53EA;&#x662F;&#x60F3;&#x8C61;&#x6210;2&#x4E2A;&#x6570;&#x636E;&#x4E2D;&#x5FC3;&#x65F6;&#x6BD4;&#x8F83;&#x597D;&#x7406;&#x89E3;.)</p>
<p>&#x6CE8;&#x610F;, &#x5728;&#x9009;&#x9879;2&#x4E2D;&#x7684;&#x7406;&#x8BBA;&#x4E0A;&quot;&#x4E0D;&#x53EF;&#x7528;&quot; (unavailable) &#x60C5;&#x51B5;&#x4E0B;, &#x6211;&#x4EEC;&#x4ECD;&#x7136;&#x5728;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x4E2D;&#x5FC3;&#x4E2D;&#x6109;&#x5FEB;&#x5730;&#x5904;&#x7406;&#x7740;&#x8BF7;&#x6C42;. &#x56E0;&#x6B64;&#x5982;&#x679C;&#x7CFB;&#x7EDF;&#x9009;&#x62E9;&#x4E86;&#x7EBF;&#x6027;&#x4E00;&#x81F4;&#x6027; (linearizability, &#x5373;&#x5B83;&#x4E0D;&#x662F;cap&#x53EF;&#x7528;&#x7684;), &#x8FD9;&#x5E76;&#x4E0D;&#x4E00;&#x5B9A;&#x610F;&#x5473;&#x7740;&#x7F51;&#x7EDC;&#x5206;&#x533A;&#x4F1A;&#x81EA;&#x52A8;&#x5BFC;&#x81F4;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x505C;&#x673A;.<br>
&#x5982;&#x679C;&#x60A8;&#x53EF;&#x4EE5;&#x5C06;&#x6240;&#x6709;&#x5BA2;&#x6237;&#x7AEF;&#x8BF7;&#x6C42;&#x8F6C;&#x79FB;&#x5230; leader &#x6570;&#x636E;&#x4E2D;&#x5FC3;, &#x90A3;&#x4E48;&#x5BA2;&#x6237;&#x7AEF;&#x5B9E;&#x9645;&#x4E0A;&#x6839;&#x672C;&#x4E0D;&#x4F1A;&#x611F;&#x89C9;&#x5230;&#x505C;&#x673A;&#x65F6;&#x95F4;.</p>
<p>&#x5728;&#x5B9E;&#x8DF5;&#x4E2D;, &#x53EF;&#x7528;&#x6027;<a href="http://blog.thislongrun.com/2015/04/cap-availability-high-availability-and_16.html">&#x5E76;&#x4E0D;&#x5B8C;&#x5168;</a>&#x4E0E; CAP &#x53EF;&#x7528;&#x6027; (CAP-availability) &#x4E00;&#x81F4;.<br>
&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7684;&#x53EF;&#x7528;&#x6027;&#x53EF;&#x80FD;&#x662F;&#x901A;&#x8FC7; SLA &#x6765;&#x8861;&#x91CF;&#x7684; (&#x4F8B;&#x5982;, 99.9% &#x7684;&#x5408;&#x6CD5;&#x8BF7;&#x6C42;&#x5FC5;&#x987B;&#x5728;1&#x79D2;&#x5185;&#x6210;&#x529F;&#x8FD4;&#x56DE;&#x54CD;&#x5E94;), &#x4F46;&#x662F;&#x8FD9;&#x6837;&#x7684; SLA &#x6307;&#x6807; CAP &#x53EF;&#x7528; (CAP-available) &#x548C; CAP &#x4E0D;&#x53EF;&#x7528; (CAP-unavailable) &#x7684;&#x7CFB;&#x7EDF;&#x90FD;&#x80FD;&#x6EE1;&#x8DB3;.</p>
<p>&#x5728;&#x5B9E;&#x8DF5;&#x4E2D;, &#x591A;&#x6570;&#x636E;&#x4E2D;&#x5FC3;&#x7CFB;&#x7EDF;&#x901A;&#x5E38;&#x8BBE;&#x8BA1;&#x4E3A;&#x5F02;&#x6B65;&#x590D;&#x5236;, &#x56E0;&#x6B64;&#x662F;&#x975E;&#x7EBF;&#x6027;&#x7684; (non-linearizable). &#x7136;&#x800C;, &#x8FD9;&#x79CD;&#x9009;&#x62E9;&#x7684;&#x539F;&#x56E0;&#x901A;&#x5E38;&#x662F;&#x7531;&#x4E8E;&#x5E7F;&#x57DF;&#x7F51;&#x7684;&#x5EF6;&#x8FDF;, &#x800C;&#x4E0D;&#x4EC5;&#x4EC5;&#x662F;&#x6570;&#x636E;&#x4E2D;&#x5FC3;&#x6545;&#x969C;&#x548C;&#x7F51;&#x7EDC;&#x6545;&#x969C;&#x5BB9;&#x707E;.</p>
<h3 class="mume-header" id="%E5%A4%9A%E6%95%B0%E7%B3%BB%E7%BB%9F%E6%97%A2%E4%B8%8D%E7%BA%BF%E6%80%A7%E5%8F%AF%E7%94%A8-linearizable-%E4%B9%9F%E4%B8%8D-cap-%E5%8F%AF%E7%94%A8-cap-available">&#x591A;&#x6570;&#x7CFB;&#x7EDF;&#x65E2;&#x4E0D;&#x7EBF;&#x6027;&#x53EF;&#x7528; (linearizable) &#x4E5F;&#x4E0D; CAP &#x53EF;&#x7528; (CAP-available)</h3>

<p>&#x5728; CAP&#x5B9A;&#x7406; &#x5BF9;&#x4E00;&#x81F4;&#x6027; (&#x7EBF;&#x6027;&#x4E00;&#x81F4;&#x6027;) &#x548C;&#x53EF;&#x7528;&#x6027;&#x7684;&#x4E25;&#x683C;&#x5B9A;&#x4E49;&#x4E0B;, &#x7CFB;&#x7EDF;&#x5982;&#x4F55;&#x8FD0;&#x884C;?</p>
<p>&#x4F8B;&#x5982;, &#x4EE5;&#x5177;&#x6709;&#x5355; leader &#x7684;&#x590D;&#x5236;&#x578B;&#x6570;&#x636E;&#x5E93;&#x4E3A;&#x4F8B;, &#x8FD9;&#x662F;&#x5927;&#x591A;&#x6570;&#x5173;&#x7CFB;&#x578B;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x914D;&#x7F6E;&#x526F;&#x672C;&#x7684;&#x6807;&#x51C6;&#x65B9;&#x6CD5;. &#x5728;&#x6B64;&#x914D;&#x7F6E;&#x4E2D;, &#x5982;&#x679C;&#x5BA2;&#x6237;&#x7AEF;&#x4E0E; leader &#x53D1;&#x751F;&#x5206;&#x533A;, &#x5219;&#x65E0;&#x6CD5;&#x5199;&#x5165;&#x6570;&#x636E;&#x5E93;.<br>
&#x5C3D;&#x7BA1;&#x6216;&#x8BB8;&#x53EF;&#x4EE5;&#x5728;&#x4ECE;&#x6570;&#x636E;&#x5E93; (&#x53EA;&#x8BFB;&#x526F;&#x672C;) &#x8BFB;&#x53D6;&#x6570;&#x636E;, &#x4F46;&#x4E0D;&#x80FD;&#x5199;&#x5165;&#x7684;&#x4E8B;&#x5B9E;&#x610F;&#x5473;&#x7740;&#x4EFB;&#x4F55;&#x5355; leader &#x7684;&#x914D;&#x7F6E;&#x90FD;&#x4E0D;&#x662F; CAP &#x53EF;&#x7528;&#x7684;. &#x5C3D;&#x7BA1;&#x8FD9;&#x6837;&#x7684;&#x914D;&#x7F6E;&#x5E38;&#x5E38;&#x88AB;&#x8425;&#x9500;&#x4E3A;&quot;&#x9AD8;&#x53EF;&#x7528;&#x6027;&quot;.</p>
<p>&#x5982;&#x679C;&#x5355; leader &#x96C6;&#x7FA4;&#x4E0D;&#x7B97; CAP &#x53EF;&#x7528;, &#x90A3;&#x662F;&#x5426;&#x610F;&#x5473;&#x7740;&#x662F; &quot;CP&quot; &#x7684;? &#x6CA1;&#x90A3;&#x4E48;&#x7B80;&#x5355;, &#x5982;&#x679C;&#x5141;&#x8BB8;&#x5E94;&#x7528;&#x8BFB;&#x53D6; follower &#x8282;&#x70B9;, &#x5E76;&#x4E14;&#x6570;&#x636E;&#x590D;&#x5236;&#x662F;&#x5F02;&#x6B65;&#x7684; (&#x5927;&#x591A;&#x6570;&#x6570;&#x636E;&#x5E93;&#x90FD;&#x662F;&#x8FD9;&#x6837;&#x7684;),<br>
&#x90A3;&#x4E48;&#x5F53;&#x4ECE; follower &#x8FDB;&#x884C;&#x8BFB;&#x53D6;&#x65F6;, follower &#x53EF;&#x80FD;&#x4F1A;&#x7A0D;&#x5FAE;&#x843D;&#x540E;&#x4E8E; leader. &#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;, &#x8BFB;&#x53D6;&#x5C31;&#x4E0D;&#x662F;&#x7EBF;&#x6027;&#x53EF;&#x7528;&#x7684;, &#x5373;&#x4E0D;&#x7B26;&#x5408; CAP &#x4E00;&#x81F4;&#x6027; (CAP-consistent).</p>
<p>&#x6B64;&#x5916;, &#x5177;&#x6709; &#x5FEB;&#x7167;&#x9694;&#x79BB;(<a href="http://research.microsoft.com/pubs/69541/tr-95-51.pdf">snapshot isolation</a>)/MVCC&#x7684;&#x6570;&#x636E;&#x5E93;&#x662F;&#x523B;&#x610F;&#x8BBE;&#x8BA1;&#x6210;&#x975E;&#x7EBF;&#x6027;&#x7684;, &#x56E0;&#x4E3A;&#x5F3A;&#x5236;&#x5B9E;&#x73B0;&#x7EBF;&#x6027;&#x4E00;&#x81F4;&#x6027;&#x4F1A;&#x964D;&#x4F4E;&#x6570;&#x636E;&#x5E93;&#x7684;&#x5E76;&#x53D1;&#x6027;&#x80FD;.<br>
&#x4F8B;&#x5982;, <a href="http://drkp.net/papers/ssi-vldb12.pdf">PostgreSQL SSI</a> &#x63D0;&#x4F9B;&#x987A;&#x5E8F;&#x4E00;&#x81F4;&#x6027; (serializability), &#x4F46;&#x4E0D;&#x63D0;&#x4F9B;&#x7EBF;&#x6027;&#x4E00;&#x81F4;&#x6027; (linearizability), &#x800C; <a href="http://www.researchgate.net/publication/220225203_Making_snapshot_isolation_serializable/file/e0b49520567eace81f.pdf">Oracle &#x8FD9;&#x4E24;&#x4E2A;&#x90FD;&#x4E0D;&#x652F;&#x6301;</a>.<br>
&#x6570;&#x636E;&#x5E93;&#x79F0;&#x4F5C;&quot;ACID&quot;&#x5E76;&#x4E0D;&#x610F;&#x5473;&#x7740;&#x5B83;&#x6EE1;&#x8DB3; CAP &#x5B9A;&#x7406;&#x4E2D;&#x5BF9;&#x4E00;&#x81F4;&#x6027;&#x7684;&#x5B9A;&#x4E49;.</p>
<p>&#x6240;&#x4EE5;&#x8FD9;&#x4E9B;&#x7CFB;&#x7EDF;&#x4E0D; CAP &#x4E00;&#x81F4;&#x4E5F;&#x4E0D; CAP &#x53EF;&#x7528;. &#x5B83;&#x4EEC;&#x65E2;&#x4E0D;&quot;CP&quot;&#x4E5F;&#x4E0D;&quot;AP&quot;, &#x53EA;&#x662F;&quot;P&quot;, &#x4E0D;&#x8BBA;&quot;P&quot;&#x5230;&#x5E95;&#x662F;&#x5565;. (&quot;&#x4E09;&#x9009;&#x4E8C;&quot;&#x7684;&#x516C;&#x5F0F;&#x786E;&#x5B9E;&#x662F;&#x53EF;&#x4EE5;&#x76F4;&#x9009;&#x4E00;&#x79CD;&#x7684;, &#x751A;&#x81F3;&#x4E09;&#x4E2A;&#x90FD;&#x4E0D;&#x9009;&#x4E5F;&#x53EF;&#x4EE5;!)</p>
<p>&#x90A3;&#x4E48;&quot;NoSQL&quot;&#x5462;? &#x4EE5; MongoDB &#x4E3A;&#x4F8B;: &#x6BCF;&#x4E2A; shard &#x4E2D;&#x6709;&#x4E00;&#x4E2A; leader (&#x53EA;&#x8981;&#x4E0D;&#x662F;&#x5728;&#x88C2;&#x8111;&#x6A21;(split-brain)&#x5F0F;&#x4E0B;, &#x5C31;&#x5E94;&#x8BE5;&#x662F;&#x8FD9;&#x6837;&#x7684;), &#x56E0;&#x6B64;&#x4E0A;&#x9762;&#x7684;&#x60C5;&#x51B5;&#x4E0D;&#x7B26;&#x5408; CAP, <a href="https://aphyr.com/posts/322-call-me-maybe-mongodb-stale-reads">Kyle &#x6700;&#x8FD1;&#x5C55;&#x793A;</a> &#x4E86;&#x5373;&#x4F7F;&#x5728;&#x6700;&#x9AD8;&#x7684;&#x4E00;&#x81F4;&#x6027;&#x8BBE;&#x7F6E;&#x4E0B;, MongoDB &#x4E5F;&#x5141;&#x8BB8;&#x975E;&#x7EBF;&#x6027;&#x8BFB;&#x53D6;, &#x6240;&#x4EE5;&#x4E0D;&#x662F; CAP&#x4E00;&#x81F4;&#x7684;.</p>
<p>&#x8FD8;&#x6709;&#x7C7B;&#x4F3C; <a href="http://www.allthingsdistributed.com/files/amazon-dynamo-sosp2007.pdf">Dynamo</a> &#x7684;&#x884D;&#x751F;&#x54C1;: Riak, Cassandra, Voldemort. &#x8FD9;&#x4E9B;&#x901A;&#x5E38;&#x88AB;&#x79F0;&#x4F5C;&quot;AP&quot;&#x662F;&#x56E0;&#x4E3A;&#x9488;&#x5BF9;&#x9AD8;&#x53EF;&#x7528;&#x4F18;&#x5316;&#x4E86;&#x4E48;?<br>
&#x8FD8;&#x662F;&#x53D6;&#x51B3;&#x4E8E;&#x4F60;&#x7684;&#x8BBE;&#x7F6E;. &#x5982;&#x679C;&#x80FD;&#x63A5;&#x53D7;&#x5355;&#x526F;&#x672C;&#x8BFB;&#x5199; (R=W=1), &#x90A3;&#x4E48;&#x5B83;&#x4EEC;&#x786E;&#x5B9E;&#x662F; CAP &#x53EF;&#x7528;&#x7684;. &#x4F46;&#x662F;, &#x5982;&#x679C;&#x9700;&#x8981;&#x4EF2;&#x88C1;&#x8BFB;&#x5199; (R+W&gt;N), &#x5E76;&#x4E14;&#x9047;&#x5230;&#x4E86;&#x7F51;&#x7EDC;&#x5206;&#x533A;, &#x8282;&#x70B9;&#x8F83;&#x5C11;&#x7684;&#x5206;&#x533A;&#x65E0;&#x6CD5;&#x8FDB;&#x884C;&#x4EF2;&#x88C1;, &#x56E0;&#x6B64;&#x4EF2;&#x88C1;&#x64CD;&#x4F5C;&#x4E0D;&#x662F; CAP &#x53EF;&#x7528;&#x7684; (&#x81F3;&#x5C11;&#x6682;&#x65F6;&#x4E0D;&#x53EF;&#x7528;, &#x76F4;&#x5230;&#x5728;&#x8282;&#x70B9;&#x8F83;&#x5C11;&#x7684;&#x5206;&#x533A;&#x8BBE;&#x7F6E;&#x5176;&#x4ED6;&#x7684;&#x6570;&#x636E;&#x5E93;&#x526F;&#x672C;&#x8282;&#x70B9;).</p>
<p>&#x6709;&#x4EBA;&#x58F0;&#x79F0;&#x4EF2;&#x88C1;&#x673A;&#x5236; (quorum) &#x7684;&#x8BFB;&#x5199;&#x53EF;&#x4EE5;&#x4FDD;&#x8BC1;&#x7EBF;&#x6027;&#x4E00;&#x81F4;&#x6027; (linearizability), &#x4F46;&#x6211;&#x8BA4;&#x4E3A;&#x4F9D;&#x8D56;&#x5B83;&#x4E0D;&#x662F;&#x4E2A;&#x660E;&#x667A;&#x7684;&#x9009;&#x62E9;,<br>
&#x6BD4;&#x5982;&#x4E00;&#x4E9B;&#x7279;&#x6027;&#x7684;&#x5FAE;&#x5999;&#x7EC4;&#x5408;: &#x677E;&#x6563;&#x4EF2;&#x88C1; (sloppy quorums),  &#x8BFB;&#x4FEE;&#x6B63; (read repair), &#x4F1A;&#x5BFC;<a href="http://basho.com/riaks-config-behaviors-part-3/">&#x81F4;&#x68D8;&#x624B;&#x7684;&#x8FB9;&#x7F18;&#x60C5;&#x51B5; (edge cases)</a>.<br>
&#x4F8B;&#x5982;&#x5220;&#x9664;&#x7684;&#x6570;&#x636E;&#x53C8;&#x51FA;&#x73B0;&#x4E86;, &#x526F;&#x672C;&#x6570;&#x91CF;&#x5C0F;&#x4E8E;&#x539F;&#x672C;&#x7684;&#x5199;&#x8282;&#x70B9;&#x6570;&#x91CF; (W) (&#x8FDD;&#x53CD;&#x4E86;&#x4EF2;&#x88C1;&#x673A;&#x5236;), &#x526F;&#x672C;&#x8282;&#x70B9;&#x6570;&#x91CF;&#x589E;&#x52A0;&#x8D85;&#x8FC7;&#x4E86;&#x526F;&#x672C;&#x603B;&#x6570; (N) (&#x8FD8;&#x662F;&#x8FDD;&#x53CD;&#x4E86;&#x4EF2;&#x88C1;&#x673A;&#x5236;). &#x8FD9;&#x4E9B;&#x60C5;&#x51B5;&#x90FD;&#x4F1A;&#x5BFC;&#x81F4;&#x7ED3;&#x679C;&#x4E0D;&#x7EBF;&#x6027;&#x4E00;&#x81F4;.</p>
<p>&#x8FD9;&#x4E9B;&#x7CFB;&#x7EDF;&#x5E76;&#x4E0D;&#x662F;&#x5F88;&#x7CDF;&#x7CD5;, &#x5927;&#x5BB6;&#x4E00;&#x76F4;&#x5728;&#x751F;&#x4EA7;&#x73AF;&#x5883;&#x4E2D;&#x6B63;&#x5E38;&#x4F7F;&#x7528;. &#x7136;&#x800C;&#x5230;&#x76EE;&#x524D;&#x4E3A;&#x6B62;, &#x8FD8;&#x4E0D;&#x80FD;&#x4E25;&#x683C;&#x5730;&#x5C06;&#x5B83;&#x4EEC;&#x5206;&#x7C7B;&#x4E3A;&quot;AP&quot;&#x6216;&quot;CP&quot;, &#x8FD9;&#x8981;&#x4E48;&#x662F;&#x56E0;&#x4E3A;&#x5FC5;&#x987B;&#x8981;&#x8FDB;&#x884C;&#x7279;&#x5B9A;&#x7684;&#x64CD;&#x4F5C;&#x6216;&#x914D;&#x7F6E;, &#x8981;&#x4E48;&#x662F;&#x56E0;&#x4E3A;&#x7CFB;&#x7EDF;&#x4E0D;&#x6EE1;&#x8DB3; CAP &#x5B9A;&#x7406;&#x4E2D;&#x5BF9;&#x4E00;&#x81F4;&#x6027;&#x6216;&#x53EF;&#x7528;&#x6027;&#x7684;&#x4E25;&#x683C;&#x5B9A;&#x4E49;.</p>
<h3 class="mume-header" id="%E6%A1%88%E4%BE%8B-zookeeper">&#x6848;&#x4F8B;: ZooKeeper</h3>

<p>&#x90A3;&#x4E48;ZooKeeper&#x5982;&#x4F55;? &#x5B83;&#x4F7F;&#x7528;&#x4E86;&#x4E00;&#x79CD;<a href="http://web.stanford.edu/class/cs347/reading/zab.pdf">&#x5171;&#x8BC6;&#x7B97;&#x6CD5;</a>, &#x56E0;&#x6B64;&#x4EBA;&#x4EEC;&#x901A;&#x5E38;&#x5C06;&#x5176;&#x89C6;&#x4E3A;&#x9009;&#x62E9;&#x4E00;&#x81F4;&#x6027;&#x653E;&#x5F03;&#x53EF;&#x7528;&#x6027;(&#x5373;&quot;CP&#x7CFB;&#x7EDF;&quot;)&#x7684;<a href="http://www.knewton.com/tech/blog/2014/12/eureka-shouldnt-use-zookeeper-service-discovery/">&#x660E;&#x786E;&#x6848;&#x4F8B;</a>.</p>
<p>&#x4F46;&#x662F;, &#x5982;&#x679C;&#x67E5;&#x770B;<a href="http://zookeeper.apache.org/doc/r3.4.6/zookeeperProgrammers.html#ch_zkGuarantees">ZooKeeper&#x6587;&#x6863;</a>, &#x5C31;&#x4F1A;&#x53D1;&#x73B0;ZooKeeper&#x5728;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#x4E0D;&#x63D0;&#x4F9B;&#x7EBF;&#x6027;&#x8BFB;&#x53D6;.<br>
&#x6BCF;&#x4E2A;&#x5BA2;&#x6237;&#x7AEF;&#x8FDE;&#x63A5;&#x5230;&#x4E00;&#x4E2A;&#x670D;&#x52A1;&#x5668;&#x8282;&#x70B9;, &#x5F53;&#x8FDB;&#x884C;&#x8BFB;&#x53D6;&#x65F6;, &#x53EA;&#x80FD;&#x770B;&#x5230;&#x8BE5;&#x8282;&#x70B9;&#x4E0A;&#x7684;&#x6570;&#x636E;, &#x65E0;&#x8BBA;&#x4F60;&#x5728;&#x53E6;&#x4E00;&#x4E2A;&#x8282;&#x70B9;&#x4E0A;&#x5199;&#x5165;&#x591A;&#x5C11;&#x65B0;&#x6570;&#x636E;.<br>
&#x8FD9;&#x4F1A;&#x6BD4;&#x8D77;&#x6BCF;&#x6B21;&#x8BFB;&#x53D6;&#x90FD;&#x5FC5;&#x987B;&#x83B7;&#x53D6;&#x4EF2;&#x88C1;&#x4FE1;&#x606F;&#x6216;&#x6BCF;&#x6B21;&#x8BFB;&#x53D6;&#x90FD;&#x4E0E;&#x4E3B;&#x8282;&#x70B9;&#x8FDB;&#x884C;&#x901A;&#x4FE1;&#x8981;&#x5FEB;&#x5F97;&#x591A;, &#x4F46;&#x8FD9;&#x4E5F;&#x610F;&#x5473;&#x7740; ZooKeeper &#x5728;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#x4E0D;&#x6EE1;&#x8DB3;CAP&#x5B9A;&#x7406;&#x4E2D;&#x5BF9;&#x4E00;&#x81F4;&#x6027;&#x7684;&#x5B9A;&#x4E49;.</p>
<p>&#x5728;ZooKeeper&#x4E2D;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5728;&#x8BFB;&#x53D6;&#x4E4B;&#x524D;&#x4F7F;&#x7528;&#x540C;&#x6B65;(sync)&#x547D;&#x4EE4;&#x8FDB;&#x884C;&#x7EBF;&#x6027;&#x5316;&#x8BFB;&#x53D6;, &#x4F46;&#x4E0D;&#x662F;&#x9ED8;&#x8BA4;&#x7684;, &#x56E0;&#x4E3A;&#x8FD9;&#x4F1A;&#x5E26;&#x6765;&#x6027;&#x80FD;&#x635F;&#x5931;. &#x786E;&#x5B9E;&#x6709;&#x4EBA;&#x4F1A;&#x4F7F;&#x7528;&#x4F1A;&#x4F7F;&#x7528;&#x540C;&#x6B65;, &#x4F46;&#x901A;&#x5E38;&#x4E0D;&#x662F;&#x6BCF;&#x6B21;&#x64CD;&#x4F5C;&#x90FD;&#x7528;.</p>
<p>ZooKeeper &#x7684;&#x53EF;&#x7528;&#x6027;&#x5982;&#x4F55;? ZooKeeper &#x9700;&#x8981;&#x8FBE;&#x6210;&#x591A;&#x6570;&#x4EF2;&#x88C1;&#x624D;&#x80FD;&#x8FBE;&#x6210;&#x4E00;&#x81F4;, &#x4E5F;&#x5C31;&#x662F;&#x8BF4;, &#x624D;&#x80FD;&#x5904;&#x7406;&#x5199;&#x64CD;&#x4F5C;.<br>
&#x5982;&#x679C;&#x53D1;&#x751F;&#x5206;&#x533A;, &#x5176;&#x4E2D;&#x4E00;&#x4FA7;&#x662F;&#x591A;&#x6570;&#x8282;&#x70B9;, &#x53E6;&#x4E00;&#x4FA7;&#x662F;&#x5C11;&#x6570;&#x8282;&#x70B9;, &#x90A3;&#x4E48;&#x591A;&#x6570;&#x8282;&#x70B9;&#x4FA7;&#x5C06;&#x7EE7;&#x7EED;&#x53EF;&#x7528;, &#x4F46;&#x662F;&#x5C11;&#x6570;&#x8282;&#x70B9;&#x4FA7;&#x5C31;&#x4E0D;&#x80FD;&#x5904;&#x7406;&#x5199;&#x64CD;&#x4F5C;, &#x5373;&#x4F7F;&#x8282;&#x70B9;&#x90FD;&#x662F;&#x6B63;&#x5E38; (up) &#x7684;. &#x56E0;&#x6B64;, ZooKeeper &#x7684;&#x5199;&#x64CD;&#x4F5C;&#x5728;&#x5206;&#x533A;&#x60C5;&#x51B5;&#x4E0B;&#x4E0D;&#x662F; CAP &#x53EF;&#x7528;&#x7684; (&#x5373;&#x4F7F;&#x591A;&#x6570;&#x8282;&#x70B9;&#x4FA7;&#x53EF;&#x4EE5;&#x7EE7;&#x7EED;&#x5904;&#x7406;&#x5199;&#x64CD;&#x4F5C;).</p>
<p>&#x6709;&#x610F;&#x601D;&#x7684;&#x662F;, ZooKeeper 3.4.0 &#x6DFB;&#x52A0;&#x4E86;<a href="http://zookeeper.apache.org/doc/r3.4.6/zookeeperAdmin.html#Experimental+Options%2FFeatures">&#x53EA;&#x8BFB;&#x6A21;&#x5F0F;</a>, &#x5728;&#x8FD9;&#x79CD;&#x6A21;&#x5F0F;&#x4E0B;&#xFF0C;&#x5206;&#x533A;&#x60C5;&#x51B5;&#x4E0B;&#x7684;&#x5C11;&#x6570;&#x8282;&#x70B9;&#x4FA7;&#x53EF;&#x4EE5;&#x7EE7;&#x7EED;&#x63D0;&#x4F9B;&#x8BFB;&#x8BF7;&#x6C42; - &#x800C;&#x4E14;&#x4E0D;&#x9700;&#x8981;&#x4EF2;&#x88C1;! &#x8FD9;&#x4E2A;&#x53EA;&#x8BFB;&#x6A21;&#x5F0F;&#x662F; CAP &#x53EF;&#x7528;&#x7684;.<br>
&#x56E0;&#x6B64;, ZooKeeper &#x5728;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#x65E2;&#x4E0D;&#x662F; CAP&#x4E00;&#x81F4;&#x7684; (CP), &#x4E5F;&#x4E0D;&#x662F; CAP &#x53EF;&#x7528;&#x7684; (AP). &#x5B83;&#x5B9E;&#x9645;&#x4E0A;&#x5C31;&#x662F;&#x4E2A;&quot;P&quot;. &#x4F46;&#x5982;&#x679C;&#x9700;&#x8981;, &#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x8C03;&#x7528;sync&#x8BA9;&#x5B83;&#x53D8;&#x6210;CP&#x7684;, &#x5982;&#x679C;&#x6253;&#x5F00;&#x6B63;&#x786E;&#x7684;&#x9009;&#x9879;, &#x5BF9;&#x4E8E;&#x8BFB;&#x64CD;&#x4F5C; (&#x800C;&#x4E0D;&#x662F;&#x5199;&#x64CD;&#x4F5C;), &#x5B83;&#x5B9E;&#x9645;&#x4E0A;&#x662F;AP&#x7684;.</p>
<p>&#x4F46;&#x8FD9;&#x4EE4;&#x4EBA;&#x607C;&#x706B;. &#x4EC5;&#x4EC5;&#x56E0;&#x4E3A; ZooKeeper &#x5728;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#x4E0D;&#x662F;&#x7EBF;&#x6027;&#x5316;&#x7684;, &#x5C31;&#x79F0;&#x4F5C;&quot;&#x4E0D;&#x4E00;&#x81F4;&quot;, &#x90A3;&#x5C31;&#x4E25;&#x91CD;&#x6B6A;&#x66F2;&#x4E86;&#x5B83;&#x7684;&#x7279;&#x6027;.<br>
&#x5B9E;&#x9645;&#x4E0A; ZooKeeper &#x63D0;&#x4F9B;&#x4E86;&#x975E;&#x5E38;&#x597D;&#x7684;&#x4E00;&#x81F4;&#x6027;! &#x5B83;&#x63D0;&#x4F9B;&#x7684; <a href="http://web.stanford.edu/class/cs347/reading/zab.pdf">&#x539F;&#x5B50;&#x5316;&#x5E7F;&#x64AD;</a> (&#x53EF;&#x7B80;&#x5316;&#x4E3A;<a href="http://courses.csail.mit.edu/6.852/08/papers/CT96-JACM.pdf">&#x5171;&#x8BC6;&#x673A;&#x5236;</a>) &#x7ED3;&#x5408;&#x4E86; session&#x4FDD;&#x969C; (session guarantee) &#x7684;<a href="http://www-i2.informatik.rwth-aachen.de/i2/fileadmin/user_upload/documents/Seminar_MCMM11/Causal_memory_1996.pdf">&#x56E0;&#x679C;&#x4E00;&#x81F4;&#x6027; (causal consistency)</a> ,<br>
&#x8FD9;&#x53EF;&#x6BD4;<a href="http://www.researchgate.net/profile/Douglas_Terry3/publication/3561300_Session_guarantees_for_weakly_consistent_replicated_data/links/02e7e52cdbe60a6cb4000000.pdf">&#x8BFB;&#x53D6;&#x5199;&#x5165;, &#x5355;&#x8C03;&#x8BFB;&#x53D6; (monotonic reads)</a> &#x548C;<a href="http://research.microsoft.com/pubs/157411/ConsistencyAndBaseballReport.pdf">&#x4E00;&#x81F4;&#x524D;&#x7F00;&#x8BFB;&#x53D6; (consistent prefix reads)</a> &#x7684;&#x7EC4;&#x5408;&#x66F4;<a href="http://arxiv.org/pdf/1302.0309.pdf">&#x5F3A;&#x5927;</a>.<br>
&#x6587;&#x6863;&#x8BF4; ZooKeeper &#x63D0;&#x4F9B;&#x4E86;<a href="http://research-srv.microsoft.com/en-us/um/people/lamport/pubs/multi.pdf">&#x987A;&#x5E8F;&#x4E00;&#x81F4;&#x6027;</a>, &#x4F46;&#x662F;&#x8FD9;&#x662F;&#x4F4E;&#x4F30;&#x4E86;&#x81EA;&#x5DF1;, &#x56E0;&#x4E3A; ZooKeeper &#x7684;&#x4FDD;&#x8BC1;&#x5B9E;&#x9645;&#x4E0A;&#x6BD4;&#x987A;&#x5E8F;&#x4E00;&#x81F4;&#x6027; (sequential consistency) &#x5F3A;&#x5F88;&#x591A;.</p>
<p>&#x6B63;&#x5982;ZooKeeper&#x6240;&#x5C55;&#x793A;&#x7684;, &#x5728;&#x5B58;&#x5728;&#x5206;&#x533A;&#x7684;&#x60C5;&#x51B5;&#x4E0B;, &#x62E5;&#x6709;&#x4E00;&#x4E2A;&#x65E2;&#x4E0D; CAP &#x4E00;&#x81F4;&#x4E5F;&#x4E0D; CAP &#x53EF;&#x7528;&#x7684;&#x7CFB;&#x7EDF;&#x662F;&#x975E;&#x5E38;&#x5408;&#x7406;&#x7684;, &#x800C;&#x4E14;&#x5728;&#x6CA1;&#x6709;&#x5206;&#x533A;&#x7684;&#x60C5;&#x51B5;&#x4E0B;, &#x7CFB;&#x7EDF;&#x5728;&#x9ED8;&#x8BA4;&#x751A;&#x81F3;&#x4E0D;&#x662F;&#x7EBF;&#x6027;&#x5316;&#x7684;. (&#x6211;&#x60F3;&#x5728; <a href="http://dbmsmusings.blogspot.co.uk/2010/04/problems-with-cap-and-yahoos-little.html">Abadi &#x7684; PACELC &#x7406;&#x8BBA;&#x6846;&#x67B6;</a>&#x91CC;, &#x8FD9;&#x5E94;&#x8BE5;&#x7B97;&#x662F;PC/EL&#x7684;&#x4E86;, &#x4F46;&#x6211;&#x89C9;&#x5F97;&#x8FD8;&#x662F;CAP&#x6BD4;&#x8F83;&#x6709;&#x542F;&#x53D1;&#x6027;.)</p>
<h3 class="mume-header" id="cp%E6%88%96ap-%E9%94%99%E8%AF%AF%E7%9A%84%E6%9D%83%E8%A1%A1">CP&#x6216;AP: &#x9519;&#x8BEF;&#x7684;&#x6743;&#x8861;</h3>

<p>&#x4E8B;&#x5B9E;&#x4E0A;&#x6211;&#x4EEC;&#x5F88;&#x96BE;&#x5C06;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x5B58;&#x50A8;&#x7CFB;&#x7EDF;&#x660E;&#x786E;&#x5730;&#x5212;&#x5206;&#x4E3A;&quot;AP&quot;&#x6216;&quot;CP&quot;, &#x8FD9;&#x4E00;&#x4E8B;&#x5B9E;&#x8BC1;&#x660E;&#x4E86;: &#x8FD9;&#x4E9B;&#x6839;&#x672C;&#x4E0D;&#x662F;&#x7CFB;&#x7EDF;&#x7684;&#x6B63;&#x786E;&#x63CF;&#x8FF0;&#x65B9;&#x5F0F;.</p>
<p>&#x6211;&#x8BA4;&#x4E3A;&#x6211;&#x4EEC;&#x4E0D;&#x5E94;&#x5C06;&#x6570;&#x636E;&#x5B58;&#x50A8;&#x7CFB;&#x7EDF;&#x5F52;&#x7C7B;&#x4E3A;&quot;AP&quot;&#x6216;&quot;CP&quot;, &#x56E0;&#x4E3A;:</p>
<ul>
<li>
<p>&#x5728;&#x7A0B;&#x5E8F;&#x4E2D;, &#x53EF;&#x80FD;&#x4F1A;&#x6709;<a href="http://groups.csail.mit.edu/tds/papers/Gilbert/Brewer2.pdf">&#x591A;&#x79CD;&#x5177;&#x6709;&#x4E00;&#x81F4;&#x6027;&#x7279;&#x5F81;&#x7684;&#x64CD;&#x4F5C;</a>.</p>
</li>
<li>
<p>&#x5728;CAP&#x5B9A;&#x7406;&#x7684;&#x5B9A;&#x4E49;&#x4E0B;, &#x8BB8;&#x591A;&#x7CFB;&#x7EDF;&#x65E2;&#x4E0D;&#x4E00;&#x81F4;&#x4E5F;&#x4E0D;&#x53EF;&#x7528;. &#x4F46;&#x4ECE;&#x6765;&#x6CA1;&#x6709;&#x542C;&#x8BF4;&#x6709;&#x4EBA;&#x628A;&#x4ED6;&#x4EEC;&#x7684;&#x7CFB;&#x7EDF;&#x53EA;&#x79F0;&#x4E3A;&quot;P&quot;, &#x5927;&#x6982;&#x662F;&#x56E0;&#x4E3A;&#x8FD9;&#x6837;&#x770B;&#x8D77;&#x6765;&#x5F88;&#x7CDF;&#x7CD5;. &#x4F46;&#x8FD9;&#x5E76;&#x4E0D;&#x5F88;&#x7CDF;&#x7CD5; - &#x5B83;&#x53EF;&#x80FD;&#x662F;&#x4E00;&#x4E2A;&#x5B8C;&#x5168;&#x5408;&#x7406;&#x7684;&#x8BBE;&#x8BA1;, &#x53EA;&#x662F;&#x4E0D;&#x9002;&#x5408;&#x5206;&#x7C7B;&#x4E3A;CP&#x6216;AP.</p>
</li>
<li>
<p>&#x5C3D;&#x7BA1;&#x5927;&#x591A;&#x6570;&#x8F6F;&#x4EF6;&#x90FD;&#x4E0D;&#x80FD;&#x5F88;&#x597D;&#x5730;&#x5206;&#x7C7B;&#x6210;&#x8FD9;&#x4E24;&#x79CD;&#x60C5;&#x51B5;, &#x4F46;&#x4EBA;&#x4EEC;&#x8FD8;&#x662F;&#x8BD5;&#x56FE;&#x5C06;&#x8F6F;&#x4EF6;&#x786C;&#x585E;&#x8FDB;&#x8FD9;&#x4E24;&#x79CD;&#x60C5;&#x51B5;&#x4E2D;&#x7684;&#x4E00;&#x79CD;, &#x4ECE;&#x800C;&#x4E0D;&#x53EF;&#x907F;&#x514D;&#x5730;&#x5C06;&quot;&#x4E00;&#x81F4;&#x6027;&quot;&#x6216;&quot;&#x53EF;&#x7528;&#x6027;&quot;&#x7684;&#x542B;&#x4E49;&#x66F4;&#x6539;&#x4E3A;&#x4EFB;&#x4F55;&#x9002;&#x5408;&#x4ED6;&#x4EEC;&#x7684;&#x5B9A;&#x4E49;.<br>
&#x4E0D;&#x5E78;&#x7684;&#x662F;, &#x5982;&#x679C;&#x8BCD;&#x4E49;&#x53D1;&#x751F;&#x53D8;&#x5316;, &#x90A3;&#x4E48;CAP&#x5B9A;&#x7406;&#x5C31;&#x4E0D;&#x518D;&#x9002;&#x7528;, &#x56E0;&#x6B64;CP/AP&#x7684;&#x533A;&#x522B;&#x5C31;&#x53D8;&#x5F97;&#x6BEB;&#x65E0;&#x610F;&#x4E49;&#x4E86;.</p>
</li>
<li>
<p>&#x5C06;&#x4E00;&#x4E2A;&#x7CFB;&#x7EDF;&#x5206;&#x7C7B;&#x4E3A;&#x8FD9;&#x4E24;&#x79CD;&#x7684;&#x4EFB;&#x4F55;&#x4E00;&#x79CD;&#x90FD;&#x4F1A;&#x4E22;&#x5931;&#x5927;&#x91CF;&#x7684;&#x7EC6;&#x8282;. &#x5728;&#x5206;&#x5E03;&#x5F0F;&#x7CFB;&#x7EDF;&#x7684;&#x8BBE;&#x8BA1;&#x4E2D;, &#x6709;&#x8BB8;&#x591A;&#x5173;&#x4E8E;&#x5BB9;&#x9519;, &#x5EF6;&#x8FDF;, &#x7F16;&#x7A0B;&#x6A21;&#x578B;&#x7684;&#x7B80;&#x5355;&#x6027;, &#x53EF;&#x64CD;&#x4F5C;&#x6027;&#x7B49;&#x65B9;&#x9762;&#x7684;&#x6743;&#x8861;. &#x8FD9;&#x4E9B;&#x4E3A;&#x5206;&#x5E03;&#x5F0F;&#x7CFB;&#x7EDF;&#x7684;&#x8BBE;&#x8BA1;&#x63D0;&#x4F9B;&#x4E86;&#x652F;&#x6491;.<br>
&#x8FD9;&#x4E9B;&#x4FE1;&#x606F;&#x662F;&#x4E0D;&#x53EF;&#x80FD;&#x7B80;&#x5355;&#x7684;&#x5C31;&#x8FD9;&#x6837;&#x63CF;&#x8FF0;&#x7684;. &#x4F8B;&#x5982;, &#x5C3D;&#x7BA1; ZooKeeper &#x6709;&#x4E00;&#x4E2A;&quot;AP&quot;&#x53EA;&#x8BFB;&#x6A21;&#x5F0F;, &#x4F46;&#x8BE5;&#x6A21;&#x5F0F;&#x4ECD;&#x7136;&#x63D0;&#x4F9B;&#x6709;&#x5E8F;&#x7684;&#x5386;&#x53F2;&#x5199;&#x5165;&#x8BB0;&#x5F55;, &#x8FD9;&#x6BD4;Riak&#x6216;Cassandra&#x7B49;&#x7CFB;&#x7EDF;&#x4E2D;&#x7684;&quot;AP&quot;&#x63D0;&#x4F9B;&#x4E86;&#x5F3A;&#x5927;&#x5F97;&#x591A;&#x7684;&#x4FDD;&#x969C; - &#x56E0;&#x6B64;&#x5C06;&#x5B83;&#x4EEC;&#x5F52;&#x4E3A;&#x4E00;&#x7C7B;&#x662F;&#x5F88;&#x8352;&#x8C2C;&#x7684;.</p>
</li>
<li>
<p>&#x5C31;&#x8FDE; Eric Brewer &#x4E5F;<a href="http://cs609.cs.ua.edu/CAP12.pdf">&#x627F;&#x8BA4;</a> CAP &#x5177;&#x6709;&#x8BEF;&#x5BFC;&#x6027;&#x800C;&#x4E14;&#x8FC7;&#x4E8E;&#x7B80;&#x5355;&#x5316;. &#x5728;2000&#x5E74;, CAP &#x7684;&#x610F;&#x4E49;&#x5728;&#x4E8E;&#x8BA8;&#x8BBA;&#x5206;&#x5E03;&#x5F0F;&#x6570;&#x636E;&#x7CFB;&#x7EDF;&#x4E2D;&#x7684;&#x6743;&#x8861;, &#x8FD9;&#x65B9;&#x9762;&#x7684;&#x786E;&#x505A;&#x5F97;&#x5F88;&#x597D;.<br>
&#x4F46;&#x5B83;&#x5E76;&#x4E0D;&#x662F;&#x4E00;&#x4E2A;&#x7A81;&#x7834;&#x6027;&#x7684;&#x6B63;&#x5F0F;&#x7ED3;&#x679C;, &#x4E5F;&#x4E0D;&#x662F;&#x4E00;&#x4E2A;&#x4E25;&#x683C;&#x7684;&#x6570;&#x636E;&#x7CFB;&#x7EDF;&#x5206;&#x7C7B;&#x65B9;&#x6848;. 15&#x5E74;&#x540E;&#x7684;&#x4ECA;&#x5929;, &#x6211;&#x4EEC;&#x6709;&#x4E86;&#x66F4;&#x591A;&#x5177;&#x6709;&#x4E0D;&#x540C;&#x4E00;&#x81F4;&#x6027;&#x548C;&#x5BB9;&#x9519;&#x6A21;&#x578B;&#x7684;&#x8861;&#x91CF;&#x5DE5;&#x5177;&#x53EF;&#x4F9B;&#x9009;&#x62E9;. CAP&#x5DF2;&#x7ECF;&#x8FBE;&#x5230;&#x4E86;&#x5B83;&#x7684;&#x76EE;&#x7684;, &#x73B0;&#x5728;&#x662F;&#x65F6;&#x5019;&#x7EE7;&#x7EED;&#x524D;&#x8FDB;&#x4E86;.</p>
</li>
</ul>
<h3 class="mume-header" id="%E5%AD%A6%E4%BC%9A%E7%8B%AC%E7%AB%8B%E6%80%9D%E8%80%83">&#x5B66;&#x4F1A;&#x72EC;&#x7ACB;&#x601D;&#x8003;</h3>

<p>&#x5982;&#x679C;CP&#x548C;AP&#x4E0D;&#x9002;&#x5408;&#x63CF;&#x8FF0;&#x548C;&#x8BC4;&#x4EF7;&#x7CFB;&#x7EDF;, &#x90A3;&#x4E48;&#x5E94;&#x8BE5;&#x4F7F;&#x7528;&#x4EC0;&#x4E48;&#x6765;&#x66FF;&#x4EE3;&#x5462;? &#x6211;&#x8BA4;&#x4E3A;&#x7B54;&#x6848;&#x4E0D;&#x662F;&#x552F;&#x4E00;&#x7684;. &#x5F88;&#x591A;&#x4EBA;&#x90FD;&#x8BA4;&#x771F;&#x601D;&#x8003;&#x8FC7;&#x8FD9;&#x4E9B;&#x95EE;&#x9898;, &#x5E76;&#x63D0;&#x51FA;&#x4E86;&#x672F;&#x8BED;&#x548C;&#x6A21;&#x578B;&#x6765;&#x5E2E;&#x52A9;&#x6211;&#x4EEC;&#x7406;&#x89E3;&#x95EE;&#x9898;. &#x8981;&#x4E86;&#x89E3;&#x8FD9;&#x4E9B;&#x89C2;&#x70B9;, &#x5FC5;&#x987B;&#x6DF1;&#x5165;&#x7814;&#x7A76;&#x6587;&#x732E;.</p>
<p><img src="./assets/images/isolation-levels.png" alt="isolation-levels"></p>
<ul>
<li>
<p>&#x4E00;&#x4E2A;&#x5F88;&#x597D;&#x7684;&#x8D77;&#x70B9;&#x662F; Doug Terry &#x7684;&#x8BBA;&#x6587;, &#x4ED6;&#x5728;<a href="http://research.microsoft.com/pubs/157411/ConsistencyAndBaseballReport.pdf">&#x6587;&#x4E2D;&#x7528;&#x68D2;&#x7403;&#x7684;&#x4F8B;&#x5B50;&#x89E3;&#x91CA;&#x4E86;&#x4E0D;&#x540C;&#x6C34;&#x5E73;&#x7684;&#x6700;&#x7EC8;&#x4E00;&#x81F4;&#x6027; (eventual consistency )</a>. &#x5373;&#x4F7F;&#x4F60;(&#x50CF;&#x6211;&#x4E00;&#x6837;)&#x4E0D;&#x662F;&#x7F8E;&#x56FD;&#x4EBA;, &#x5BF9;&#x68D2;&#x7403;&#x4E00;&#x65E0;&#x6240;&#x77E5;, &#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#x4E5F;&#x975E;&#x5E38;&#x6E05;&#x6670;&#x6613;&#x61C2;.</p>
</li>
<li>
<p>&#x5982;&#x679C;&#x5BF9;&#x4E8B;&#x52A1;&#x9694;&#x79BB;&#x6A21;&#x578B;&#x611F;&#x5174;&#x8DA3;(&#x8FD9;&#x4E0E;&#x5206;&#x5E03;&#x5F0F;&#x526F;&#x672C;&#x7684;&#x4E00;&#x81F4;&#x6027;&#x4E0D;&#x4E00;&#x6837;, &#x4F46;&#x6BD4;&#x8F83;&#x76F8;&#x5173;), &#x90A3;&#x4E48;&#x53EF;&#x4EE5;&#x4E86;&#x89E3;&#x4E0B;&#x6211;&#x7684;&#x5C0F;&#x9879;&#x76EE; <a href="http://martin.kleppmann.com/2014/11/25/hermitage-testing-the-i-in-acid.html">Hermitage</a>.</p>
</li>
<li>
<p><a href="http://arxiv.org/pdf/1302.0309.pdf">Peter Bailis &#x7B49;&#x4EBA;</a>&#x63A2;&#x7D22;&#x4E86;&#x526F;&#x672C;&#x4E00;&#x81F4;&#x6027; (replica consistency), &#x4E8B;&#x52A1;&#x9694;&#x79BB; (transaction isolation) &#x548C;&#x53EF;&#x7528;&#x6027; (availability) &#x4E4B;&#x95F4;&#x7684;&#x8054;&#x7CFB; (&#x8FD9;&#x7BC7;&#x8BBA;&#x6587;&#x8FD8;&#x89E3;&#x91CA;&#x4E86; Kyle Kingsbury <a href="https://aphyr.com/posts/322-call-me-maybe-mongodb-stale-reads">&#x559C;&#x6B22;&#x5C55;&#x793A;</a>&#x7684;&#x4E00;&#x81F4;&#x6027;&#x5C42;&#x6B21;&#x7ED3;&#x6784;&#x7684;&#x610F;&#x4E49;).</p>
</li>
<li>
<p>&#x5F53;&#x4F60;&#x8BFB;&#x8FC7;&#x8FD9;&#x4E9B;&#x4E4B;&#x540E;, &#x8BE5;&#x51C6;&#x5907;&#x597D;&#x4E86;&#x6DF1;&#x5165;&#x7814;&#x7A76;&#x8FD9;&#x4E9B;&#x6587;&#x732E;. &#x6211;&#x5728;&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#x4E2D;&#x653E;&#x4E86;&#x5927;&#x91CF;&#x7684;&#x6587;&#x7AE0;&#x94FE;&#x63A5;. &#x4E00;&#x5B9A;&#x8981;&#x770B;&#x4E00;&#x770B;: &#x8BB8;&#x591A;&#x4E13;&#x5BB6;&#x5DF2;&#x7ECF;&#x4E3A;&#x4F60;&#x89E3;&#x51B3;&#x4E86;&#x5F88;&#x591A;&#x95EE;&#x9898;.</p>
</li>
<li>
<p>&#x6700;&#x540E;, &#x5982;&#x679C;&#x4F60;&#x65E0;&#x6CD5;&#x9605;&#x8BFB;&#x90A3;&#x4E9B;&#x8BBA;&#x6587;, &#x6211;&#x5EFA;&#x8BAE;&#x4F60;&#x770B;&#x770B;&#x6211;&#x7684;<a href="http://dataintensive.net/">&#x4E66;</a>, &#x4E66;&#x4E2D;&#x4EE5;&#x5E73;&#x6613;&#x8FD1;&#x4EBA;&#x7684;&#x65B9;&#x5F0F;&#x603B;&#x7ED3;&#x4E86;&#x6700;&#x91CD;&#x8981;&#x7684;&#x4E00;&#x4E9B;&#x7406;&#x5FF5;. (&#x770B;, &#x6211;&#x975E;&#x5E38;&#x52AA;&#x529B;&#x5730;&#x4E0D;&#x8BA9;&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#x6210;&#x4E3A;&#x4E00;&#x7BC7;&#x8F6F;&#x6587;.)</p>
</li>
<li>
<p>&#x5982;&#x679C;&#x4F60;&#x60F3;&#x66F4;&#x5177;&#x4F53;&#x5730;&#x77E5;&#x9053;&#x5982;&#x4F55;&#x6B63;&#x786E;&#x4F7F;&#x7528; ZooKeeper, <a href="http://shop.oreilly.com/product/0636920028901.do">Flavio Junqueira &#x548C; Benjamin Reed &#x7684;&#x4E66;</a>&#x662F;&#x4E0D;&#x9519;&#x7684;.</p>
</li>
</ul>
<p>&#x65E0;&#x8BBA;&#x4F60;&#x9009;&#x62E9;&#x600E;&#x6837;&#x7684;&#x5B66;&#x4E60;&#x65B9;&#x5F0F;, &#x6211;&#x9F13;&#x52B1;&#x4F60;&#x4FDD;&#x6301;&#x597D;&#x5947;&#x5FC3;&#x548C;&#x8010;&#x5FC3; - &#x8FD9;&#x4E9B;&#x4E1C;&#x897F;&#x6765;&#x4E4B;&#x4E0D;&#x6613;. &#x4F46;&#x662F;&#x8FD9;&#x662F;&#x6709;&#x597D;&#x5904;&#x7684;&#xFF0C;&#x56E0;&#x4E3A;&#x4F60;&#x5B66;&#x4F1A;&#x4E86;&#x6743;&#x8861;&#x5229;&#x5F0A;, &#x4ECE;&#x800C;&#x786E;&#x5B9A;&#x54EA;&#x79CD;&#x4F53;&#x7CFB;&#x7ED3;&#x6784;&#x6700;&#x9002;&#x5408;&#x60A8;&#x7684;&#x7279;&#x5B9A;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;. &#x4F46;&#x662F;&#x65E0;&#x8BBA;&#x4F60;&#x505A;&#x4EC0;&#x4E48;, &#x8BF7;&#x505C;&#x6B62;&#x8C08;&#x8BBA;CP&#x548C;AP, &#x56E0;&#x4E3A;&#x5B83;&#x4EEC;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x610F;&#x4E49;.</p>
<p>&#x611F;&#x8C22; Kyle Kingsbury &#x548C; Camille Fournier &#x5BF9;&#x672C;&#x6587;&#x8349;&#x7A3F;&#x7684;&#x6CE8;&#x89E3;. &#x5F53;&#x7136;, &#x4EFB;&#x4F55;&#x9519;&#x8BEF;&#x6216;&#x4EE4;&#x4EBA;&#x4E0D;&#x5FEB;&#x7684;&#x610F;&#x89C1;&#x90FD;&#x662F;&#x6211;&#x7684;&#x9505;.</p>

      </div>
      <div class="md-sidebar-toc"><ul>
<li><a href="#%E8%AF%B7%E4%B8%8D%E8%A6%81%E7%BB%A7%E7%BB%AD%E5%B0%86%E6%95%B0%E6%8D%AE%E5%BA%93%E7%A7%B0%E4%B8%BA-cp-%E6%88%96-ap">&#x8BF7;&#x4E0D;&#x8981;&#x7EE7;&#x7EED;&#x5C06;&#x6570;&#x636E;&#x5E93;&#x79F0;&#x4E3A;  CP &#x6216; AP</a>
<ul>
<li><a href="#cap-%E5%AE%9A%E4%B9%89%E9%9D%9E%E5%B8%B8%E7%8B%AD%E9%9A%98">CAP &#x5B9A;&#x4E49;&#x975E;&#x5E38;&#x72ED;&#x9698;</a></li>
<li><a href="#%E7%BA%BF%E6%80%A7%E4%B8%80%E8%87%B4%E6%80%A7-linearizability">&#x7EBF;&#x6027;&#x4E00;&#x81F4;&#x6027; (Linearizability)</a></li>
<li><a href="#cap-availability">CAP-Availability</a></li>
<li><a href="#%E5%A4%9A%E6%95%B0%E7%B3%BB%E7%BB%9F%E6%97%A2%E4%B8%8D%E7%BA%BF%E6%80%A7%E5%8F%AF%E7%94%A8-linearizable-%E4%B9%9F%E4%B8%8D-cap-%E5%8F%AF%E7%94%A8-cap-available">&#x591A;&#x6570;&#x7CFB;&#x7EDF;&#x65E2;&#x4E0D;&#x7EBF;&#x6027;&#x53EF;&#x7528; (linearizable) &#x4E5F;&#x4E0D; CAP &#x53EF;&#x7528; (CAP-available)</a></li>
<li><a href="#%E6%A1%88%E4%BE%8B-zookeeper">&#x6848;&#x4F8B;: ZooKeeper</a></li>
<li><a href="#cp%E6%88%96ap-%E9%94%99%E8%AF%AF%E7%9A%84%E6%9D%83%E8%A1%A1">CP&#x6216;AP: &#x9519;&#x8BEF;&#x7684;&#x6743;&#x8861;</a></li>
<li><a href="#%E5%AD%A6%E4%BC%9A%E7%8B%AC%E7%AB%8B%E6%80%9D%E8%80%83">&#x5B66;&#x4F1A;&#x72EC;&#x7ACB;&#x601D;&#x8003;</a></li>
</ul>
</li>
</ul>
</div>
      <a id="sidebar-toc-btn">&#x2261;</a>
    
    
    
    
    
    
    
    
<script>

var sidebarTOCBtn = document.getElementById('sidebar-toc-btn')
sidebarTOCBtn.addEventListener('click', function(event) {
  event.stopPropagation()
  if (document.body.hasAttribute('html-show-sidebar-toc')) {
    document.body.removeAttribute('html-show-sidebar-toc')
  } else {
    document.body.setAttribute('html-show-sidebar-toc', true)
  }
})
</script>
      
  
    </body></html>